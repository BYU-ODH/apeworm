function _round(number) {
  return Math.round(number*1000)/1000;
}

module( "normalization" );

test( "Bark Scale", function() {
  var formants = [100,1200,2400];
  var expected = [4.576785506909767, 13.456341854458003].map(_round);
  var f1 = VowelWorm.Normalization.barkScale(formants[2]) - VowelWorm.Normalization.barkScale(formants[1]);
  var f2 = VowelWorm.Normalization.barkScale(formants[2]) - VowelWorm.Normalization.barkScale(formants[0]);
  deepEqual(_round(f1), expected[0]);
  deepEqual(_round(f2), expected[1]);
});

test( "Regression", function() {
  var mfccs = [-8.096073,0.049780,0.445308,-0.539998,0.297224,-0.606007,0.173577,-0.357058,0.310168,-0.344864,0.046812,-0.267189,0.100604,-0.445007,0.096448,-0.353373,0.025801,-0.351567,-0.048782,-0.253812,-0.089156,-0.377310,-0.104855,-0.222116,-0.118072];
  
  var expected_backness = 1.0227;
  var expected_height = 1.3248;

  var result = VowelWorm.normalize(mfccs, VowelWorm.Normalization.regression);
  var backness = result[0];
  var height = result[1];

  close(backness, expected_backness, 0.001, 'backness');
  close(height, expected_height, 0.001, 'height');
});

module( "smoothing" );

test( "convolve method", function() {
  var y = [191,172,184,172,168,195,163,195,169,176,179,170,171, 156,174,168,188,148,143,172,170,152,141,141,171,188, 195,198,201,188,225,255,255,244,170,224,253,248,208, 168,222,240,225,170,179,220,227,201,163,201,228,224, 184,172,205,222,206,177,187,221,229,204,198,211,237, 236,207,199,223,238,223,201,202,229,238,215,187,202, 227,228,207,201,220,240,236,216,205,203,210,199,174, 166,167,169,158,155,158,165,160,149,148,144,138,136, 133,131,129,131,134,126,122,130,125,125,122,123,128, 124,116,109,119,125,117,108,113,118,116,118,118,114, 113,115,108,102,117,126,119,115,117,126,127,130,130, 134,137,139,152,149,141,152,164,171,169,168,172,180, 182,175,164,151,152,150,148,149,145,138,130,143,143, 142,135,135,139,141,151,150,145,148,147,154,153,148, 152,147,131,124,110,97,94,88,88,99,115,129,129, 126,125,127,130,126,119,121,121,121,122,122,107,108, 115,119,108,108,111,107,111,106,110,110,116,119,113, 104,115,125,128,133,129,120,107,110,113,117,110,113, 121,126,121,110,99,97,107,117,121,118,124,125,123, 121,118,115,114,116,111,116,121,127,125,125,126,128, 131,129,123,118,115,105,114,106,98,96,95,96,85, 78,69,63,40,37,42,42,45,42,35,26,28,36, 45,46,47,48,44,45,51,53,62,65,59,48,41, 55,47,40,46,60,65,64,70,82,84,82,78,86, 81,82,93,103,106,104,106,111,115,107,96,93,87, 86,92,92,91,95,88,72,57,52,64,61,53,54, 55,54,56,56,55,65,65,64,64,74,74,73,69, 63,74,80,78,78,68,84,95,91,82,84,86,86, 81,86,87,76,82,91,95,82,91,100,89,91,95, 86,87,84,75,62,64,61,57,51,45,40,37,35, 24,30,31,30,21,27,24,29,25,23,32,34,22, 30,37,41,37,27,30,27,23,26,22,15,8,3, 0,5,12,10,13,19,15,13,23,24,21,30,42, 49,49,45,54,66,66,60,59,65,70,69,59,72, 69,79,79,72,77,78,84,82,77,81,93,96,97, 93,93,102,103,100,102,102,98,99,100,96,95,99, 92,96,101,91,96,105,108,100,103,111,115,113,105, 96,106,100,96,88,100,104,98,98,90,84,86,88, 77,74,80,89,82,74,74,76,76,69,75,81,81, 81,88,91,93,87,92,93,83,83,81,86,85,81, 87,85,89,85,77,64,74,81,73,65,72,79,70, 59,60,63,69,68,60,58,64,64,54,60,49,40, 54,48,46,52,55,50,50,43,40,43,48,50,47, 56,63,56,62,73,62,57,76,75,78,73,75,79, 77,80,74,69,74,86,89,88,83,82,86,85,76, 66,73,76,76,71,71,70,64,51,48,59,61,53, 50,65,73,73,73,71,68,71,89,96,94,83,83, 86,87,90,91,91,86,83,88,85,79,90,85,86, 89,94,82,79,90,102,105,99,96,102,102,99,110, 112,103,94,97,107,105,99,99,89,82,79,84,88, 95,102,100,97,101,101,101,91,72,72,76,74,64, 59,59,58,54,57,52,55,65,65,60,57,64,67, 65,60,63,68,65,61,63,59,63,59,65,82,83, 85,85,88,92,94,108,113,104,107,105,101,93,95, 97,89,92,93,92,108,102,106,100,95,99,96,98, 96,92,93,93,86,87,87,89,84,82,85,84,84, 81,73,86,96,99,98,94,96,106,112,116,107,112, 104,102,101,90,89,89,92,87,78,74,69,71,59, 60,64,56,69,81,86,82,87,84,90,95,89,88, 94,102,106,102,93,92,105,109,109,99,102,105,101, 108,110,110,113,108,116,116,113,104,100,105,106,105, 100,94,103,98,90,93,107,108,96,84,92,93,95, 97,98,95,93,88,83,91,90,82,84,94,97,89, 99,104,99,94,95,103,92,92,99,99,104,99,101, 101,100,107,104,97,103,105,106,107,103,97,89,92, 97,96,90,90,97,91,91,98,94,87,82,72,77, 80,76,81,75,73,75,70,68,66,68,64,59,51, 51,60,60,60,60,57,59,64,68,64,58,57,42, 62,63,59,57,57,60,58,59,63,57,63,67,66, 58,54,48,50,58,59,55,64,74,71,71,74,85, 88,87,76,81,88,101,104,104,95,91,95,107,107, 103,93,92,104,108,103,91,91,97,92,78,85,91, 89,84,79,76,77,79,79,76,76,70,65,66,66, 69,64,64,58,54,60,58,61,64,60,54,54,58, 58,60,67,70,67,63,73,80,77,72,79,82,78, 77,79,85,96,86,77,73,70,83,79,84,65,85, 97,85,82,84,98,101,91,83,85,97,98,99,95, 92,89,90,93,91,95,92,92,83,83,91,84,83, 78,77,80,75,78,80,82,79,75,69,73,74,65, 64,63,63,59,52,56,52,57,52,52,45,47,44, 39,39,34,34,27,31,30,23,19,14,15,16,19, 23,30,31,27,34,34,39,39,44,47,45,52,52, 57,52,56,52,59,63,63,64,65,74,73,69];
  var m = [0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182];

  var desired = [191.09090909,191.65454545,192.27272727,192.14545455,192.41818182,193.38181818,194.,194.74545455,194.8,195.56363636,196.67272727,197.70909091,198.38181818,198.89090909,200.10909091,201.27272727,202.27272727,202.50909091,203.49090909,205.05454545,206.25454545,207.07272727,207.70909091,208.81818182,210.38181818,211.41818182,211.76363636,211.87272727,212.27272727,212.98181818,213.85454545,213.69090909,212.78181818,211.83636364,211.21818182,211.74545455,210.83636364,209.25454545,207.78181818,207.07272727,206.89090909,205.67272727,204.18181818,203.09090909,202.90909091,202.36363636,201.05454545,199.54545455,198.4,197.90909091,196.67272727,194.90909091,193.18181818,192.21818182,191.52727273,190.09090909,188.27272727,186.89090909,185.94545455,184.81818182,183.01818182,181.09090909,179.70909091,178.36363636,176.63636364,174.30909091,172.18181818,170.69090909,169.2,167.10909091,164.83636364,162.92727273,161.38181818,159.85454545,157.83636364,155.58181818,153.72727273,152.41818182,150.70909091,148.43636364,146.41818182,144.94545455,143.45454545,141.54545455,139.30909091,137.30909091,135.69090909,134.32727273,133.,131.61818182,130.49090909,129.85454545,129.6,129.27272727,128.76363636,128.65454545,128.81818182,129.05454545,129.12727273,129.27272727,129.69090909,130.27272727,130.96363636,131.63636364,132.14545455,132.47272727,132.85454545,133.23636364,133.54545455,133.81818182,134.16363636,134.45454545,134.45454545,134.78181818,135.10909091,135.47272727,135.69090909,135.81818182,136.09090909,136.54545455,137.30909091,137.87272727,138.23636364,138.8,139.50909091,140.25454545,140.89090909,141.47272727,142.09090909,142.61818182,142.92727273,143.12727273,143.03636364,142.83636364,142.69090909,142.16363636,141.47272727,141.10909091,141.10909091,141.32727273,141.38181818,141.36363636,141.27272727,141.21818182,141.14545455,140.94545455,140.58181818,140.01818182,139.50909091,139.14545455,138.6,137.83636364,136.67272727,135.56363636,134.6,133.63636364,132.32727273,130.98181818,129.81818182,128.78181818,128.05454545,127.21818182,126.49090909,125.8,125.2,124.72727273,124.27272727,123.8,123.29090909,122.96363636,122.70909091,122.67272727,122.56363636,122.21818182,121.6,120.85454545,120.18181818,119.67272727,118.98181818,118.36363636,117.76363636,117.27272727,116.78181818,116.01818182,115.14545455,114.52727273,114.21818182,114.34545455,114.78181818,115.21818182,115.87272727,116.54545455,116.98181818,117.09090909,116.89090909,116.63636364,116.41818182,116.25454545,115.96363636,115.70909091,115.61818182,115.76363636,115.83636364,115.90909091,116.,116.10909091,116.27272727,116.67272727,116.94545455,117.,116.92727273,116.87272727,116.98181818,116.89090909,116.72727273,116.45454545,116.25454545,116.,115.54545455,114.85454545,113.94545455,113.03636364,111.87272727,110.45454545,108.94545455,107.38181818,105.78181818,104.2,102.65454545,101.18181818,99.69090909,98.29090909,96.98181818,95.81818182,94.61818182,93.29090909,91.8,90.41818182,89.34545455,88.50909091,87.87272727,87.10909091,86.05454545,84.72727273,83.32727273,82.07272727,80.65454545,79.14545455,77.78181818,76.72727273,75.81818182,74.90909091,74.07272727,73.54545455,72.96363636,72.25454545,71.36363636,70.65454545,69.85454545,69.05454545,68.41818182,67.90909091,67.49090909,67.14545455,66.92727273,66.85454545,67.03636364,66.90909091,66.72727273,66.63636364,66.47272727,66.30909091,66.23636364,66.36363636,66.6,67.07272727,67.52727273,68.10909091,68.47272727,68.65454545,69.05454545,69.34545455,69.54545455,69.89090909,70.41818182,70.89090909,71.25454545,71.45454545,71.61818182,71.94545455,72.25454545,72.61818182,72.96363636,73.38181818,73.76363636,73.96363636,74.03636364,74.10909091,74.58181818,75.29090909,75.70909091,76.27272727,76.78181818,77.47272727,78.10909091,78.58181818,78.90909091,79.16363636,79.23636364,79.27272727,79.25454545,79.4,79.41818182,79.32727273,79.32727273,79.29090909,79.14545455,78.70909091,78.47272727,78.36363636,77.96363636,77.52727273,77.30909091,77.12727273,77.01818182,76.96363636,76.76363636,76.21818182,75.70909091,75.16363636,74.47272727,73.8,73.30909091,73.,72.72727273,72.2,71.52727273,71.10909091,70.69090909,70.23636364,69.63636364,69.10909091,68.52727273,68.05454545,67.32727273,66.56363636,65.98181818,65.43636364,64.49090909,63.69090909,63.03636364,62.52727273,62.05454545,61.2,60.29090909,59.36363636,58.36363636,57.6,56.47272727,55.01818182,53.50909091,52.07272727,50.54545455,49.07272727,47.72727273,46.43636364,45.10909091,43.87272727,42.76363636,41.50909091,40.27272727,38.98181818,37.87272727,36.76363636,35.70909091,34.98181818,34.21818182,33.30909091,32.72727273,32.34545455,32.01818182,31.74545455,31.69090909,31.70909091,31.87272727,32.09090909,32.23636364,32.72727273,33.25454545,34.01818182,34.81818182,35.69090909,36.54545455,37.4,38.38181818,39.49090909,40.4,41.43636364,42.6,43.89090909,45.23636364,46.34545455,47.41818182,48.87272727,50.2,51.34545455,52.45454545,53.63636364,54.92727273,56.18181818,57.50909091,58.83636364,60.09090909,61.49090909,62.89090909,64.49090909,66.27272727,67.92727273,69.58181818,71.27272727,73.05454545,74.63636364,76.16363636,77.90909091,79.76363636,81.4,82.87272727,84.23636364,85.61818182,86.67272727,87.52727273,88.23636364,89.23636364,90.14545455,90.72727273,91.30909091,91.85454545,92.30909091,92.69090909,93.01818182,93.16363636,93.43636364,93.58181818,93.94545455,94.,93.90909091,93.94545455,93.92727273,93.89090909,93.61818182,93.49090909,93.56363636,93.56363636,93.34545455,93.2,93.09090909,93.09090909,92.98181818,92.8,92.61818182,92.30909091,91.96363636,91.58181818,91.36363636,91.10909091,90.76363636,90.6,90.41818182,90.23636364,90.10909091,89.76363636,89.09090909,88.78181818,88.50909091,87.92727273,87.14545455,86.63636364,86.2,85.45454545,84.43636364,83.47272727,82.70909091,82.21818182,81.52727273,80.8,80.10909091,79.67272727,79.01818182,78.10909091,77.41818182,76.52727273,75.61818182,75.07272727,74.38181818,73.61818182,73.16363636,72.81818182,72.27272727,71.56363636,70.85454545,70.23636364,69.67272727,69.16363636,68.69090909,68.29090909,67.94545455,67.61818182,67.16363636,66.81818182,66.54545455,66.01818182,65.36363636,65.16363636,64.85454545,64.58181818,64.4,64.25454545,64.21818182,64.05454545,63.96363636,63.83636364,63.50909091,63.30909091,63.25454545,63.32727273,63.52727273,63.87272727,64.01818182,64.10909091,64.32727273,64.52727273,64.41818182,64.30909091,64.41818182,64.72727273,64.92727273,65.07272727,65.09090909,65.01818182,64.85454545,64.67272727,64.58181818,64.52727273,64.50909091,64.32727273,64.61818182,65.21818182,65.56363636,66.01818182,66.47272727,66.76363636,67.05454545,67.76363636,68.6,69.52727273,70.30909091,71.03636364,71.72727273,72.4,73.18181818,73.81818182,74.32727273,74.87272727,75.25454545,75.52727273,75.94545455,76.34545455,76.6,76.78181818,76.92727273,77.21818182,77.56363636,77.61818182,77.65454545,77.83636364,78.34545455,79.,79.45454545,79.63636364,79.87272727,80.12727273,80.41818182,80.92727273,81.4,81.72727273,82.05454545,82.61818182,83.23636364,83.76363636,84.18181818,84.69090909,85.01818182,85.23636364,85.50909091,86.10909091,86.83636364,87.49090909,88.23636364,89.09090909,89.94545455,90.6,91.10909091,91.61818182,91.94545455,91.96363636,92.03636364,92.12727273,91.85454545,91.27272727,90.63636364,90.2,89.74545455,89.16363636,88.61818182,87.92727273,87.27272727,86.8,86.41818182,86.,85.43636364,85.05454545,84.83636364,84.38181818,83.92727273,83.50909091,83.12727273,82.6,82.21818182,81.92727273,81.36363636,80.65454545,79.81818182,79.2,78.94545455,78.6,78.29090909,78.03636364,77.63636364,77.27272727,77.10909091,77.36363636,77.65454545,77.6,77.63636364,77.74545455,77.78181818,77.85454545,78.09090909,78.41818182,78.50909091,78.58181818,78.54545455,78.36363636,78.50909091,78.6,78.69090909,78.67272727,78.56363636,78.70909091,79.14545455,79.61818182,79.98181818,80.30909091,80.83636364,81.45454545,81.94545455,82.47272727,83.07272727,83.65454545,84.23636364,84.72727273,85.09090909,85.43636364,85.87272727,86.30909091,86.47272727,86.81818182,87.38181818,88.09090909,88.72727273,89.2,89.76363636,90.58181818,91.47272727,92.50909091,93.30909091,94.27272727,94.98181818,95.34545455,95.67272727,95.76363636,95.83636364,95.85454545,95.85454545,95.72727273,95.18181818,94.47272727,93.83636364,93.18181818,92.34545455,91.6,91.07272727,90.36363636,89.85454545,89.70909091,89.6,89.4,89.30909091,88.87272727,88.65454545,88.45454545,88.25454545,88.12727273,88.03636364,88.14545455,88.29090909,88.4,88.41818182,88.4,88.61818182,89.03636364,89.43636364,89.65454545,89.89090909,90.27272727,90.61818182,91.03636364,91.50909091,91.98181818,92.56363636,93.2,93.74545455,94.10909091,94.36363636,94.47272727,94.58181818,94.74545455,94.74545455,94.61818182,94.32727273,94.09090909,93.92727273,93.81818182,93.6,93.45454545,93.76363636,94.10909091,94.23636364,94.09090909,94.18181818,94.45454545,94.83636364,95.34545455,95.83636364,96.49090909,97.09090909,97.52727273,98.01818182,98.41818182,98.58181818,98.50909091,98.54545455,98.67272727,98.90909091,98.89090909,98.96363636,99.23636364,99.43636364,99.43636364,99.30909091,99.25454545,99.07272727,99.05454545,99.18181818,99.07272727,98.98181818,98.8,98.83636364,98.81818182,98.72727273,98.83636364,98.76363636,98.52727273,98.4,98.25454545,98.21818182,98.05454545,97.81818182,97.52727273,97.25454545,97.10909091,96.96363636,96.78181818,96.50909091,96.32727273,96.38181818,96.16363636,96.03636364,96.18181818,96.2,95.83636364,95.36363636,94.92727273,94.8,94.58181818,94.27272727,94.01818182,93.61818182,93.16363636,92.8,92.38181818,92.01818182,91.70909091,91.29090909,90.81818182,90.4,89.8,89.01818182,88.34545455,87.81818182,87.10909091,86.30909091,85.54545455,84.90909091,84.34545455,83.70909091,83.2,82.58181818,81.81818182,80.78181818,80.01818182,79.36363636,78.6,77.8,77.01818182,76.16363636,75.32727273,74.63636364,73.90909091,73.03636364,72.25454545,71.52727273,70.85454545,70.14545455,69.50909091,68.70909091,67.85454545,67.16363636,66.6,65.96363636,65.36363636,65.05454545,64.69090909,64.2,63.83636364,63.8,63.90909091,64.18181818,64.16363636,64.18181818,64.4,64.76363636,65.29090909,65.85454545,66.21818182,66.6,67.09090909,67.83636364,68.54545455,69.25454545,69.87272727,70.61818182,71.58181818,72.45454545,73.23636364,73.8,74.36363636,75.09090909,75.69090909,75.94545455,76.25454545,76.74545455,77.30909091,77.8,78.47272727,78.72727273,78.98181818,79.34545455,79.74545455,80.09090909,80.38181818,80.6,80.70909091,80.76363636,80.92727273,81.03636364,80.98181818,80.94545455,80.94545455,80.94545455,81.16363636,81.30909091,81.36363636,81.45454545,81.54545455,81.36363636,81.,80.76363636,80.52727273,80.27272727,79.94545455,79.61818182,79.25454545,79.01818182,78.87272727,78.72727273,78.29090909,77.70909091,77.25454545,77.01818182,76.78181818,76.45454545,75.94545455,75.54545455,75.41818182,75.29090909,75.01818182,74.45454545,73.76363636,73.4,73.18181818,73.05454545,72.47272727,72.34545455,72.69090909,72.69090909,72.52727273,72.43636364,72.69090909,73.09090909,73.36363636,73.47272727,73.58181818,73.90909091,74.30909091,74.72727273,75.18181818,75.67272727,76.09090909,76.52727273,76.96363636,77.45454545,78.01818182,78.63636364,79.32727273,79.74545455,80.2,80.74545455,81.10909091,81.52727273,81.96363636,82.38181818,82.78181818,83.09090909,83.41818182,83.65454545,83.87272727,84.09090909,84.30909091,84.23636364,84.10909091,84.05454545,83.92727273,83.65454545,83.30909091,83.03636364,82.70909091,82.21818182,81.69090909,80.89090909,80.36363636,79.90909091,79.52727273,79.07272727,78.41818182,77.78181818,76.96363636,76.49090909,75.56363636,74.41818182,73.36363636,72.43636364,71.45454545,70.09090909,68.6,67.2,65.96363636,64.70909091,63.29090909,61.92727273,60.67272727,59.50909091,58.32727273,57.32727273,56.30909091,55.32727273,54.38181818,53.45454545,52.63636364,51.78181818,51.21818182,50.65454545,50.03636364,49.45454545,48.96363636,48.49090909,48.16363636,47.85454545,47.63636364,47.38181818,47.10909091,46.96363636,46.85454545,46.74545455];

  deepEqual(VowelWorm.convolve(m,y), VowelWorm.convolve(y,m), "Convolution ignores argument order.");
  deepEqual(VowelWorm.convolve(m,y).length, desired.length, "Convolution is the correct length.");
  deepEqual(VowelWorm.convolve(m,y).map(Math.round), desired.map(Math.round), "Convolution matches expected output.");
});

test( "Savitzky-Golay method", function() {
  var vowel = [198,201,188,225,255,255,244,170,224,253,248,208,168,222,240,225,170,179,220,227,201,163,201,228,224,184,172,205,222,206,177,187,221,229,204,198,211,237,236,207,199,223,238,223,201,202,229,238,215,187,202,227,228,207,201,220,240,236,216,205,203,210,199,174,166,167,169,158,155,158,165,160,149,148,144,138,136,133,131,129,131,134,126,122,130,125,125,122,123,128,124,116,109,119,125,117,108,113,118,116,118,118,114,113,115,108,102,117,126,119,115,117,126,127,130,130,134,137,139,152,149,141,152,164,171,169,168,172,180,182,175,164,151,152,150,148,149,145,138,130,143,143,142,135,135,139,141,151,150,145,148,147,154,153,148,152,147,131,124,110,97,94,88,88,99,115,129,129,126,125,127,130,126,119,121,121,121,122,122,107,108,115,119,108,108,111,107,111,106,110,110,116,119,113,104,115,125,128,133,129,120,107,110,113,117,110,113,121,126,121,110,99,97,107,117,121,118,124,125,123,121,118,115,114,116,111,116,121,127,125,125,126,128,131,129,123,118,115,105,114,106,98,96,95,96,85,78,69,63,40,37,42,42,45,42,35,26,28,36,45,46,47,48,44,45,51,53,62,65,59,48,41,55,47,40,46,60,65,64,70,82,84,82,78,86,81,82,93,103,106,104,106,111,115,107,96,93,87,86,92,92,91,95,88,72,57,52,64,61,53,54,55,54,56,56,55,65,65,64,64,74,74,73,69,63,74,80,78,78,68,84,95,91,82,84,86,86,81,86,87,76,82,91,95,82,91,100,89,91,95,86,87,84,75,62,64,61,57,51,45,40,37,35,24,30,31,30,21,27,24,29,25,23,32,34,22,30,37,41,37,27,30,27,23,26,22,15,8,3,0,5,12,10,13,19,15,13,23,24,21,30,42,49,49,45,54,66,66,60,59,65,70,69,59,72,69,79,79,72,77,78,84,82,77,81,93,96,97,93,93,102,103,100,102,102,98,99,100,96,95,99,92,96,101,91,96,105,108,100,103,111,115,113,105,96,106,100,96,88,100,104,98,98,90,84,86,88,77,74,80,89,82,74,74,76,76,69,75,81,81,81,88,91,93,87,92,93,83,83,81,86,85,81,87,85,89,85,77,64,74,81,73,65,72,79,70,59,60,63,69,68,60,58,64,64,54,60,49,40,54,48,46,52,55,50,50,43,40,43,48,50,47,56,63,56,62,73,62,57,76,75,78,73,75,79,77,80,74,69,74,86,89,88,83,82,86,85,76,66,73,76,76,71,71,70,64,51,48,59,61,53,50,65,73,73,73,71,68,71,89,96,94,83,83,86,87,90,91,91,86,83,88,85,79,90,85,86,89,94,82,79,90,102,105,99,96,102,102,99,110,112,103,94,97,107,105,99,99,89,82,79,84,88,95,102,100,97,101,101,101,91,72,72,76,74,64,59,59,58,54,57,52,55,65,65,60,57,64,67,65,60,63,68,65,61,63,59,63,59,65,82,83,85,85,88,92,94,108,113,104,107,105,101,93,95,97,89,92,93,92,108,102,106,100,95,99,96,98,96,92,93,93,86,87,87,89,84,82,85,84,84,81,73,86,96,99,98,94,96,106,112,116,107,112,104,102,101,90,89,89,92,87,78,74,69,71,59,60,64,56,69,81,86,82,87,84,90,95,89,88,94,102,106,102,93,92,105,109,109,99,102,105,101,108,110,110,113,108,116,116,113,104,100,105,106,105,100,94,103,98,90,93,107,108,96,84,92,93,95,97,98,95,93,88,83,91,90,82,84,94,97,89,99,104,99,94,95,103,92,92,99,99,104,99,101,101,100,107,104,97,103,105,106,107,103,97,89,92,97,96,90,90,97,91,91,98,94,87,82,72,77,80,76,81,75,73,75,70,68,66,68,64,59,51,51,60,60,60,60,57,59,64,68,64,58,57,42,62,63,59,57,57,60,58,59,63,57,63,67,66,58,54,48,50,58,59,55,64,74,71,71,74,85,88,87,76,81,88,101,104,104,95,91,95,107,107,103,93,92,104,108,103,91,91,97,92,78,85,91,89,84,79,76,77,79,79,76,76,70,65,66,66,69,64,64,58,54,60,58,61,64,60,54,54,58,58,60,67,70,67,63,73,80,77,72,79,82,78,77,79,85,96,86,77,73,70,83,79,84,65,85,97,85,82,84,98,101,91,83,85,97,98,99,95,92,89,90,93,91,95,92,92,83,83,91,84,83,78,77,80,75,78,80,82,79,75,69,73,74,65,64,63,63,59,52,56,52,57,52,52,45,47,44,39,39,34,34,27,31,30,23,19,14,15];
  var WINDOW_SIZE = 55;
  var ORDER = 1;
  var DERIVATIVE = 0;
  var desired = [191.09090909,191.65454545,192.27272727,192.14545455,192.41818182,193.38181818,194.,194.74545455,194.8,195.56363636,196.67272727,197.70909091,198.38181818,198.89090909,200.10909091,201.27272727,202.27272727,202.50909091,203.49090909,205.05454545,206.25454545,207.07272727,207.70909091,208.81818182,210.38181818,211.41818182,211.76363636,211.87272727,212.27272727,212.98181818,213.85454545,213.69090909,212.78181818,211.83636364,211.21818182,211.74545455,210.83636364,209.25454545,207.78181818,207.07272727,206.89090909,205.67272727,204.18181818,203.09090909,202.90909091,202.36363636,201.05454545,199.54545455,198.4,197.90909091,196.67272727,194.90909091,193.18181818,192.21818182,191.52727273,190.09090909,188.27272727,186.89090909,185.94545455,184.81818182,183.01818182,181.09090909,179.70909091,178.36363636,176.63636364,174.30909091,172.18181818,170.69090909,169.2,167.10909091,164.83636364,162.92727273,161.38181818,159.85454545,157.83636364,155.58181818,153.72727273,152.41818182,150.70909091,148.43636364,146.41818182,144.94545455,143.45454545,141.54545455,139.30909091,137.30909091,135.69090909,134.32727273,133.,131.61818182,130.49090909,129.85454545,129.6,129.27272727,128.76363636,128.65454545,128.81818182,129.05454545,129.12727273,129.27272727,129.69090909,130.27272727,130.96363636,131.63636364,132.14545455,132.47272727,132.85454545,133.23636364,133.54545455,133.81818182,134.16363636,134.45454545,134.45454545,134.78181818,135.10909091,135.47272727,135.69090909,135.81818182,136.09090909,136.54545455,137.30909091,137.87272727,138.23636364,138.8,139.50909091,140.25454545,140.89090909,141.47272727,142.09090909,142.61818182,142.92727273,143.12727273,143.03636364,142.83636364,142.69090909,142.16363636,141.47272727,141.10909091,141.10909091,141.32727273,141.38181818,141.36363636,141.27272727,141.21818182,141.14545455,140.94545455,140.58181818,140.01818182,139.50909091,139.14545455,138.6,137.83636364,136.67272727,135.56363636,134.6,133.63636364,132.32727273,130.98181818,129.81818182,128.78181818,128.05454545,127.21818182,126.49090909,125.8,125.2,124.72727273,124.27272727,123.8,123.29090909,122.96363636,122.70909091,122.67272727,122.56363636,122.21818182,121.6,120.85454545,120.18181818,119.67272727,118.98181818,118.36363636,117.76363636,117.27272727,116.78181818,116.01818182,115.14545455,114.52727273,114.21818182,114.34545455,114.78181818,115.21818182,115.87272727,116.54545455,116.98181818,117.09090909,116.89090909,116.63636364,116.41818182,116.25454545,115.96363636,115.70909091,115.61818182,115.76363636,115.83636364,115.90909091,116.,116.10909091,116.27272727,116.67272727,116.94545455,117.,116.92727273,116.87272727,116.98181818,116.89090909,116.72727273,116.45454545,116.25454545,116.,115.54545455,114.85454545,113.94545455,113.03636364,111.87272727,110.45454545,108.94545455,107.38181818,105.78181818,104.2,102.65454545,101.18181818,99.69090909,98.29090909,96.98181818,95.81818182,94.61818182,93.29090909,91.8,90.41818182,89.34545455,88.50909091,87.87272727,87.10909091,86.05454545,84.72727273,83.32727273,82.07272727,80.65454545,79.14545455,77.78181818,76.72727273,75.81818182,74.90909091,74.07272727,73.54545455,72.96363636,72.25454545,71.36363636,70.65454545,69.85454545,69.05454545,68.41818182,67.90909091,67.49090909,67.14545455,66.92727273,66.85454545,67.03636364,66.90909091,66.72727273,66.63636364,66.47272727,66.30909091,66.23636364,66.36363636,66.6,67.07272727,67.52727273,68.10909091,68.47272727,68.65454545,69.05454545,69.34545455,69.54545455,69.89090909,70.41818182,70.89090909,71.25454545,71.45454545,71.61818182,71.94545455,72.25454545,72.61818182,72.96363636,73.38181818,73.76363636,73.96363636,74.03636364,74.10909091,74.58181818,75.29090909,75.70909091,76.27272727,76.78181818,77.47272727,78.10909091,78.58181818,78.90909091,79.16363636,79.23636364,79.27272727,79.25454545,79.4,79.41818182,79.32727273,79.32727273,79.29090909,79.14545455,78.70909091,78.47272727,78.36363636,77.96363636,77.52727273,77.30909091,77.12727273,77.01818182,76.96363636,76.76363636,76.21818182,75.70909091,75.16363636,74.47272727,73.8,73.30909091,73.,72.72727273,72.2,71.52727273,71.10909091,70.69090909,70.23636364,69.63636364,69.10909091,68.52727273,68.05454545,67.32727273,66.56363636,65.98181818,65.43636364,64.49090909,63.69090909,63.03636364,62.52727273,62.05454545,61.2,60.29090909,59.36363636,58.36363636,57.6,56.47272727,55.01818182,53.50909091,52.07272727,50.54545455,49.07272727,47.72727273,46.43636364,45.10909091,43.87272727,42.76363636,41.50909091,40.27272727,38.98181818,37.87272727,36.76363636,35.70909091,34.98181818,34.21818182,33.30909091,32.72727273,32.34545455,32.01818182,31.74545455,31.69090909,31.70909091,31.87272727,32.09090909,32.23636364,32.72727273,33.25454545,34.01818182,34.81818182,35.69090909,36.54545455,37.4,38.38181818,39.49090909,40.4,41.43636364,42.6,43.89090909,45.23636364,46.34545455,47.41818182,48.87272727,50.2,51.34545455,52.45454545,53.63636364,54.92727273,56.18181818,57.50909091,58.83636364,60.09090909,61.49090909,62.89090909,64.49090909,66.27272727,67.92727273,69.58181818,71.27272727,73.05454545,74.63636364,76.16363636,77.90909091,79.76363636,81.4,82.87272727,84.23636364,85.61818182,86.67272727,87.52727273,88.23636364,89.23636364,90.14545455,90.72727273,91.30909091,91.85454545,92.30909091,92.69090909,93.01818182,93.16363636,93.43636364,93.58181818,93.94545455,94.,93.90909091,93.94545455,93.92727273,93.89090909,93.61818182,93.49090909,93.56363636,93.56363636,93.34545455,93.2,93.09090909,93.09090909,92.98181818,92.8,92.61818182,92.30909091,91.96363636,91.58181818,91.36363636,91.10909091,90.76363636,90.6,90.41818182,90.23636364,90.10909091,89.76363636,89.09090909,88.78181818,88.50909091,87.92727273,87.14545455,86.63636364,86.2,85.45454545,84.43636364,83.47272727,82.70909091,82.21818182,81.52727273,80.8,80.10909091,79.67272727,79.01818182,78.10909091,77.41818182,76.52727273,75.61818182,75.07272727,74.38181818,73.61818182,73.16363636,72.81818182,72.27272727,71.56363636,70.85454545,70.23636364,69.67272727,69.16363636,68.69090909,68.29090909,67.94545455,67.61818182,67.16363636,66.81818182,66.54545455,66.01818182,65.36363636,65.16363636,64.85454545,64.58181818,64.4,64.25454545,64.21818182,64.05454545,63.96363636,63.83636364,63.50909091,63.30909091,63.25454545,63.32727273,63.52727273,63.87272727,64.01818182,64.10909091,64.32727273,64.52727273,64.41818182,64.30909091,64.41818182,64.72727273,64.92727273,65.07272727,65.09090909,65.01818182,64.85454545,64.67272727,64.58181818,64.52727273,64.50909091,64.32727273,64.61818182,65.21818182,65.56363636,66.01818182,66.47272727,66.76363636,67.05454545,67.76363636,68.6,69.52727273,70.30909091,71.03636364,71.72727273,72.4,73.18181818,73.81818182,74.32727273,74.87272727,75.25454545,75.52727273,75.94545455,76.34545455,76.6,76.78181818,76.92727273,77.21818182,77.56363636,77.61818182,77.65454545,77.83636364,78.34545455,79.,79.45454545,79.63636364,79.87272727,80.12727273,80.41818182,80.92727273,81.4,81.72727273,82.05454545,82.61818182,83.23636364,83.76363636,84.18181818,84.69090909,85.01818182,85.23636364,85.50909091,86.10909091,86.83636364,87.49090909,88.23636364,89.09090909,89.94545455,90.6,91.10909091,91.61818182,91.94545455,91.96363636,92.03636364,92.12727273,91.85454545,91.27272727,90.63636364,90.2,89.74545455,89.16363636,88.61818182,87.92727273,87.27272727,86.8,86.41818182,86.,85.43636364,85.05454545,84.83636364,84.38181818,83.92727273,83.50909091,83.12727273,82.6,82.21818182,81.92727273,81.36363636,80.65454545,79.81818182,79.2,78.94545455,78.6,78.29090909,78.03636364,77.63636364,77.27272727,77.10909091,77.36363636,77.65454545,77.6,77.63636364,77.74545455,77.78181818,77.85454545,78.09090909,78.41818182,78.50909091,78.58181818,78.54545455,78.36363636,78.50909091,78.6,78.69090909,78.67272727,78.56363636,78.70909091,79.14545455,79.61818182,79.98181818,80.30909091,80.83636364,81.45454545,81.94545455,82.47272727,83.07272727,83.65454545,84.23636364,84.72727273,85.09090909,85.43636364,85.87272727,86.30909091,86.47272727,86.81818182,87.38181818,88.09090909,88.72727273,89.2,89.76363636,90.58181818,91.47272727,92.50909091,93.30909091,94.27272727,94.98181818,95.34545455,95.67272727,95.76363636,95.83636364,95.85454545,95.85454545,95.72727273,95.18181818,94.47272727,93.83636364,93.18181818,92.34545455,91.6,91.07272727,90.36363636,89.85454545,89.70909091,89.6,89.4,89.30909091,88.87272727,88.65454545,88.45454545,88.25454545,88.12727273,88.03636364,88.14545455,88.29090909,88.4,88.41818182,88.4,88.61818182,89.03636364,89.43636364,89.65454545,89.89090909,90.27272727,90.61818182,91.03636364,91.50909091,91.98181818,92.56363636,93.2,93.74545455,94.10909091,94.36363636,94.47272727,94.58181818,94.74545455,94.74545455,94.61818182,94.32727273,94.09090909,93.92727273,93.81818182,93.6,93.45454545,93.76363636,94.10909091,94.23636364,94.09090909,94.18181818,94.45454545,94.83636364,95.34545455,95.83636364,96.49090909,97.09090909,97.52727273,98.01818182,98.41818182,98.58181818,98.50909091,98.54545455,98.67272727,98.90909091,98.89090909,98.96363636,99.23636364,99.43636364,99.43636364,99.30909091,99.25454545,99.07272727,99.05454545,99.18181818,99.07272727,98.98181818,98.8,98.83636364,98.81818182,98.72727273,98.83636364,98.76363636,98.52727273,98.4,98.25454545,98.21818182,98.05454545,97.81818182,97.52727273,97.25454545,97.10909091,96.96363636,96.78181818,96.50909091,96.32727273,96.38181818,96.16363636,96.03636364,96.18181818,96.2,95.83636364,95.36363636,94.92727273,94.8,94.58181818,94.27272727,94.01818182,93.61818182,93.16363636,92.8,92.38181818,92.01818182,91.70909091,91.29090909,90.81818182,90.4,89.8,89.01818182,88.34545455,87.81818182,87.10909091,86.30909091,85.54545455,84.90909091,84.34545455,83.70909091,83.2,82.58181818,81.81818182,80.78181818,80.01818182,79.36363636,78.6,77.8,77.01818182,76.16363636,75.32727273,74.63636364,73.90909091,73.03636364,72.25454545,71.52727273,70.85454545,70.14545455,69.50909091,68.70909091,67.85454545,67.16363636,66.6,65.96363636,65.36363636,65.05454545,64.69090909,64.2,63.83636364,63.8,63.90909091,64.18181818,64.16363636,64.18181818,64.4,64.76363636,65.29090909,65.85454545,66.21818182,66.6,67.09090909,67.83636364,68.54545455,69.25454545,69.87272727,70.61818182,71.58181818,72.45454545,73.23636364,73.8,74.36363636,75.09090909,75.69090909,75.94545455,76.25454545,76.74545455,77.30909091,77.8,78.47272727,78.72727273,78.98181818,79.34545455,79.74545455,80.09090909,80.38181818,80.6,80.70909091,80.76363636,80.92727273,81.03636364,80.98181818,80.94545455,80.94545455,80.94545455,81.16363636,81.30909091,81.36363636,81.45454545,81.54545455,81.36363636,81.,80.76363636,80.52727273,80.27272727,79.94545455,79.61818182,79.25454545,79.01818182,78.87272727,78.72727273,78.29090909,77.70909091,77.25454545,77.01818182,76.78181818,76.45454545,75.94545455,75.54545455,75.41818182,75.29090909,75.01818182,74.45454545,73.76363636,73.4,73.18181818,73.05454545,72.47272727,72.34545455,72.69090909,72.69090909,72.52727273,72.43636364,72.69090909,73.09090909,73.36363636,73.47272727,73.58181818,73.90909091,74.30909091,74.72727273,75.18181818,75.67272727,76.09090909,76.52727273,76.96363636,77.45454545,78.01818182,78.63636364,79.32727273,79.74545455,80.2,80.74545455,81.10909091,81.52727273,81.96363636,82.38181818,82.78181818,83.09090909,83.41818182,83.65454545,83.87272727,84.09090909,84.30909091,84.23636364,84.10909091,84.05454545,83.92727273,83.65454545,83.30909091,83.03636364,82.70909091,82.21818182,81.69090909,80.89090909,80.36363636,79.90909091,79.52727273,79.07272727,78.41818182,77.78181818,76.96363636,76.49090909,75.56363636,74.41818182,73.36363636,72.43636364,71.45454545,70.09090909,68.6,67.2,65.96363636,64.70909091,63.29090909,61.92727273,60.67272727,59.50909091,58.32727273,57.32727273,56.30909091,55.32727273,54.38181818,53.45454545,52.63636364,51.78181818,51.21818182,50.65454545,50.03636364,49.45454545,48.96363636,48.49090909,48.16363636,47.85454545,47.63636364,47.38181818,47.10909091,46.96363636,46.85454545,46.74545455];
  var result = VowelWorm.savitzkyGolay(vowel, WINDOW_SIZE, ORDER);
  var uint8result = VowelWorm.savitzkyGolay(new Uint8Array(vowel), WINDOW_SIZE, ORDER);

  deepEqual(result.map(Math.round), desired.map(Math.round), "Smoothing matches expected.");
  deepEqual(uint8result.map(Math.round), desired.map(Math.round), "Smoothing works with unsigned array.");
});

test( "Hanning window", function() {
  var vowel = [3.4, -5, 2.31, 40, 6.4, -34.38, 10, 300, -20, 0, 15];
  var window_size = 5;
  var expected = [ 9.905, -1.0725, -0.8, -1.0725, 9.905, 22.1775, 4.605, -13.09, 71.405, 147.5, 65., -1.25, 11.25, 11.25, -1.25 ]

  VowelWorm._HANNING_WINDOW[window_size] = new Float32Array([ 0 ,  0.5,  1 ,  0.5,  0 ]);

  var result = VowelWorm.hann(vowel, window_size)
  deepEqual(result.map(_round), expected.map(_round), "Hanning window accurate.");
});

test("MFCC", function() {
  var worm = new VowelWorm.instance();
  var data = [-93.3050537109375,-87.50777435302734,-79.35485076904297,-76.73424530029297,-65.16865539550781,-45.917327880859375,-39.91524124145508,-43.03449630737305,-56.98241424560547,-75.06877136230469,-69.58043670654297,-51.16716766357422,-43.74345397949219,-45.44194030761719,-57.022762298583984,-84.21512603759766,-89.513916015625,-72.37787628173828,-63.38224411010742,-63.662498474121094,-73.81289672851562,-91.87560272216797,-90.1786117553711,-79.11804962158203,-69.15283966064453,-68.12608337402344,-76.03089904785156,-93.9231948852539,-100.77576446533203,-93.96466064453125,-83.48873901367188,-81.5118408203125,-88.0051040649414,-99.76193237304688,-99.2847900390625,-97.5682373046875,-88.82618713378906,-85.72958374023438,-90.31333923339844,-99.4310073852539,-101.45651245117188,-102.45123291015625,-96.43125915527344,-91.77325439453125,-94.66595458984375,-101.09815979003906,-103.60213470458984,-104.56658935546875,-94.55662536621094,-88.38421630859375,-89.74333190917969,-95.84941101074219,-100.97785949707031,-104.39368438720703,-102.28736114501953,-99.30398559570312,-99.1294174194336,-100.48483276367188,-101.21509552001953,-102.40998840332031,-102.74524688720703,-101.34341430664062,-101.24645233154297,-100.76707458496094,-100.3076171875,-101.37115478515625,-103.08808135986328,-101.43464660644531,-99.92843627929688,-100.443359375,-100.09088134765625,-99.86282348632812,-99.60948181152344,-96.41934204101562,-94.63011932373047,-96.55381774902344,-99.5960693359375,-100.45482635498047,-101.7324447631836,-100.45643615722656,-99.32755279541016,-100.0955810546875,-101.25520324707031,-100.2323989868164,-100.55148315429688,-99.08332061767578,-98.114013671875,-99.40326690673828,-102.1542739868164,-102.70221710205078,-103.7032470703125,-100.46665954589844,-98.91837310791016,-100.93512725830078,-100.33573913574219,-99.68695068359375,-99.35276794433594,-92.48462677001953,-86.91963958740234,-86.85059356689453,-93.91925048828125,-99.96514892578125,-96.38470458984375,-89.12236022949219,-83.72412109375,-83.67115783691406,-88.56101989746094,-93.39193725585938,-93.54096221923828,-90.7667236328125,-87.26795959472656,-87.40028381347656,-90.34003448486328,-92.84102630615234,-93.75871276855469,-93.71636199951172,-90.08450317382812,-88.74449157714844,-91.76483154296875,-95.4343032836914,-97.22975158691406,-96.0983657836914,-94.60197448730469,-98.14027404785156,-96.3571548461914,-93.68757629394531,-92.50765991210938,-93.83647918701172,-88.26142120361328,-86.39647674560547,-89.31004333496094,-90.24634552001953,-89.21395874023438,-88.34884643554688,-83.94371032714844,-84.07962799072266,-85.9012222290039,-83.21061706542969,-79.82341003417969,-77.02616882324219,-73.40689086914062,-71.68341064453125,-72.77637481689453,-75.41761779785156,-77.32872009277344,-76.92451477050781,-75.33120727539062,-75.89395141601562,-77.03459167480469,-78.53807830810547,-80.38078308105469,-80.81365966796875,-80.26780700683594,-80.0618896484375,-80.11053466796875,-76.71878051757812,-77.58287048339844,-78.08707427978516,-79.62870788574219,-76.52912139892578,-75.78701782226562,-77.08968353271484,-79.32333374023438,-81.77503967285156,-81.72169494628906,-79.60086822509766,-81.00978088378906,-83.18749237060547,-84.08489990234375,-84.6994857788086,-86.82234954833984,-85.93742370605469,-86.459228515625,-88.26014709472656,-89.76486206054688,-90.2983169555664,-90.43834686279297,-90.68622589111328,-90.97074890136719,-93.84388732910156,-93.18668365478516,-92.25364685058594,-93.15000915527344,-91.67534637451172,-91.60287475585938,-90.76785278320312,-90.57626342773438,-92.0560531616211,-92.35222625732422,-90.30227661132812,-89.73774719238281,-88.3331298828125,-85.845703125,-84.70512390136719,-84.04137420654297,-85.31269073486328,-89.84520721435547,-92.89848327636719,-92.26068115234375,-92.05062103271484,-94.22522735595703,-91.69351196289062,-88.00872802734375,-85.55671691894531,-85.5184555053711,-86.2286376953125,-86.80787658691406,-85.50827026367188,-87.10075378417969,-89.33328247070312,-91.65592956542969,-96.1642074584961,-95.20150756835938,-94.08294677734375,-91.17900085449219,-88.52110290527344,-87.65084838867188,-88.3958740234375,-92.10883331298828,-97.14171600341797,-95.1327133178711,-93.65576934814453,-94.9124984741211,-99.66423034667969,-101.64907836914062,-98.80904388427734,-96.71670532226562,-96.5573501586914,-98.52699279785156,-99.52770233154297,-98.023681640625,-99.61268615722656,-100.46607971191406,-99.7261962890625,-98.18482208251953,-98.16039276123047,-98.21977233886719,-100.7435302734375,-100.61267852783203,-99.07402801513672,-97.9569091796875,-100.24052429199219,-101.2370376586914,-102.00691986083984,-100.91558837890625,-102.07078552246094,-103.86612701416016,-104.26593017578125,-104.86095428466797,-108.23822784423828,-109.91160583496094,-109.50532531738281,-108.08631134033203,-107.587890625,-108.49407958984375,-109.35779571533203,-107.33717346191406,-105.82937622070312,-106.55406188964844,-110.52688598632812,-111.1592025756836,-110.31300354003906,-109.77882385253906,-109.40408325195312,-109.49339294433594,-111.1107177734375,-108.37362670898438,-106.39445495605469,-103.37826538085938,-100.1601791381836,-96.18125915527344,-93.523193359375,-94.05879974365234,-96.2767105102539,-97.62387084960938,-99.92230224609375,-103.8472900390625,-105.53096771240234,-105.79930114746094,-106.76827239990234,-105.11201477050781,-104.38391876220703,-103.39500427246094,-102.74085998535156,-101.85064697265625,-103.97235107421875,-104.775390625,-105.10600280761719,-105.86051177978516,-105.09811401367188,-101.66877746582031,-101.48829650878906,-101.0977554321289,-99.94281005859375,-100.14643859863281,-101.53565216064453,-99.03504180908203,-98.53753662109375,-99.44164276123047,-100.61338806152344,-103.40812683105469,-109.0464096069336,-107.43119812011719,-104.8782958984375,-104.98566436767578,-104.92448425292969,-104.03341674804688,-103.96183776855469,-102.49980926513672,-102.04759216308594,-103.970458984375,-104.45460510253906,-101.69564056396484,-101.10379028320312,-99.0743408203125,-96.21061706542969,-96.04083251953125,-97.67645263671875,-95.62915802001953,-97.29292297363281,-97.91191101074219,-91.95259857177734,-90.64071655273438,-93.34867858886719,-95.49075317382812,-98.64022827148438,-101.92872619628906,-99.80601501464844,-98.05548095703125,-98.68743896484375,-97.54441833496094,-98.82211303710938,-101.1380844116211,-98.2052993774414,-96.66142272949219,-95.72230529785156,-95.88497924804688,-96.3597412109375,-96.22195434570312,-97.0070571899414,-98.3778076171875,-98.26007843017578,-98.56563568115234,-100.68077087402344,-103.20712280273438,-103.00686645507812,-103.78304290771484,-105.4640121459961,-104.46824645996094,-101.48583221435547,-100.79132080078125,-100.7127456665039,-100.35240936279297,-98.62734985351562,-97.40485382080078,-97.87499237060547,-97.69247436523438,-97.32379150390625,-98.39016723632812,-99.208984375,-97.40157318115234,-98.79608917236328,-101.76834106445312,-102.97188568115234,-101.5087890625,-101.31607818603516,-100.2890853881836,-99.73321533203125,-99.96497344970703,-100.75118255615234,-101.60747528076172,-104.4319839477539,-105.03997802734375,-105.67931365966797,-107.44412231445312,-105.58302307128906,-105.28849792480469,-106.97132873535156,-106.91246032714844,-107.90801239013672,-106.4308853149414,-104.7678451538086,-106.19883728027344,-105.77020263671875,-107.77986145019531,-107.5324935913086,-107.65409851074219,-107.11785888671875,-108.06388092041016,-107.59223175048828,-108.22418975830078,-106.11601257324219,-107.29889678955078,-107.13321685791016,-104.31163787841797,-102.57872009277344,-103.82170867919922,-104.90887451171875,-105.06277465820312,-105.20989227294922,-103.7398681640625,-103.81167602539062,-103.40450286865234,-103.9211654663086,-106.27205657958984,-108.90888977050781,-110.43540954589844,-107.55137634277344,-107.01953125,-106.44322204589844,-107.08892059326172,-107.0432357788086,-109.98492431640625,-114.59388732910156,-114.08547973632812,-113.53919982910156,-113.4360122680664,-112.73580932617188,-115.489013671875,-115.39657592773438,-112.48725128173828,-112.2071762084961,-113.06514739990234,-113.26351928710938,-113.5969467163086,-110.40916442871094,-110.22034454345703,-109.21139526367188,-110.76416778564453,-112.02847290039062,-109.36351013183594,-105.87609100341797,-106.13427734375,-105.47384643554688,-105.6705322265625,-107.40904998779297,-108.86869812011719,-108.94092559814453,-109.46610260009766,-112.21561431884766,-110.65882873535156,-108.73484802246094,-109.7432632446289,-110.52554321289062,-111.65038299560547,-113.62176513671875,-113.00624084472656,-111.74229431152344,-110.94519805908203,-112.17072296142578,-110.66000366210938,-110.88944244384766,-110.92752075195312,-108.35929107666016,-107.74475860595703,-106.13231658935547,-104.23046875,-103.76557922363281,-102.00686645507812,-100.61591339111328,-103.56062316894531,-106.46853637695312,-105.072021484375,-104.41776275634766,-103.20227813720703,-104.05097198486328,-104.97256469726562,-107.80996704101562,-108.01963806152344,-109.84747314453125,-110.33985900878906,-107.451416015625,-106.6316146850586,-106.6084213256836,-105.43694305419922,-105.66436767578125,-106.30131530761719,-103.36730194091797,-103.23806762695312,-104.2667007446289,-103.42772674560547,-102.4825210571289,-101.23187255859375,-100.198486328125,-103.55571746826172,-105.14034271240234,-105.09170532226562,-105.95948791503906,-108.18317413330078,-109.69100952148438,-110.16548919677734,-109.64790344238281,-109.43470764160156,-110.5691909790039,-111.53301239013672,-109.59625244140625,-107.73566436767578,-107.9970474243164,-110.19032287597656,-109.6241683959961,-107.57122039794922,-106.60629272460938,-108.8272933959961,-110.30615997314453,-109.19363403320312,-107.30966186523438,-105.00544738769531,-103.32884216308594,-103.24187469482422,-104.70905303955078,-105.01457977294922,-105.76446533203125,-104.9629135131836,-104.76405334472656,-107.7711410522461,-108.49789428710938,-109.74179077148438,-109.08003234863281,-109.02507019042969,-107.56317901611328,-108.88126373291016,-110.1395263671875,-108.98674011230469,-107.27841186523438,-107.88372802734375,-108.79893493652344,-110.77420043945312,-112.72618103027344,-111.5513916015625,-107.78323364257812,-108.71482849121094,-111.40898895263672,-112.05589294433594,-112.36275482177734,-110.23715209960938,-105.82111358642578,-106.9056396484375,-109.8525161743164,-109.45301818847656,-110.63248443603516,-112.5880126953125,-109.79907989501953,-109.34208679199219,-110.27442169189453,-110.74222564697266,-111.40479278564453,-108.99170684814453,-105.77071380615234,-106.4958267211914,-107.33184051513672,-106.7542953491211,-108.67855072021484,-110.98091888427734,-109.50801086425781,-109.48130798339844,-111.21937561035156,-110.12445068359375,-111.26148223876953,-111.94978332519531,-110.00772094726562,-110.13485717773438,-114.52168273925781,-114.85563659667969,-115.40615844726562,-116.07840728759766,-115.14518737792969,-116.32566833496094,-114.43782806396484,-113.3719711303711,-110.39187622070312,-108.82637023925781,-109.26498413085938,-109.52891540527344,-111.24252319335938,-112.42044067382812,-113.0626220703125,-114.94332885742188,-116.23345184326172,-113.13507843017578,-114.08817291259766,-118.69493103027344,-113.90670013427734,-112.66641235351562,-114.51457977294922,-116.23795318603516,-115.0663070678711,-116.97789001464844,-114.62907409667969,-113.79024505615234,-115.81227111816406,-115.76754760742188,-113.01667785644531,-111.78977966308594,-112.03861236572266,-111.48356628417969,-113.75349426269531,-116.32083129882812,-115.27816772460938,-114.51560974121094,-115.27682495117188,-115.2805404663086,-115.37344360351562,-112.80021667480469,-113.39767456054688,-114.13697052001953,-114.402099609375,-114.9102783203125,-115.43687438964844,-116.75121307373047,-119.74774169921875,-117.92536926269531,-116.56706237792969,-117.7164077758789,-116.96422576904297,-116.04884338378906,-119.5843505859375,-119.75587463378906,-118.30342102050781,-116.89105224609375,-116.9161605834961,-117.91304016113281,-121.95802307128906,-118.98863983154297,-119.60542297363281,-119.38395690917969,-117.78106689453125,-117.6446533203125,-120.06224060058594,-121.26715850830078,-118.96186065673828,-117.409912109375,-116.06360626220703,-116.1027603149414,-117.8580322265625,-115.73599243164062,-115.49472045898438,-116.29974365234375,-116.73844146728516,-115.16204071044922,-114.23019409179688,-114.632568359375,-113.15174102783203,-113.24198913574219,-113.3273696899414,-112.2152099609375,-113.99954986572266,-113.63236236572266,-112.5662612915039,-113.31531524658203,-115.2945327758789,-116.71102905273438,-116.0672836303711,-114.7282485961914,-115.25132751464844,-117.71894836425781,-117.94280242919922,-115.69541931152344,-115.42361450195312,-116.03794860839844,-116.47120666503906,-116.64567565917969,-116.21699523925781,-115.7142562866211,-115.31468200683594,-115.09144592285156,-114.42668914794922,-115.04328918457031,-115.82102966308594,-115.2669677734375,-114.72911071777344,-117.2763442993164,-117.6143798828125,-118.75373840332031,-116.39302062988281,-112.79756164550781,-110.64828491210938,-111.9454345703125,-110.92693328857422,-111.28279113769531,-113.2381820678711,-111.77494812011719,-108.50109100341797,-106.67510223388672,-108.29881286621094,-108.72103881835938,-108.66091918945312,-108.02336883544922,-108.37706756591797,-107.35210418701172,-104.7117691040039,-104.01757049560547,-106.0523681640625,-107.17489624023438,-106.70685577392578,-104.263671875,-101.77200317382812,-101.18548583984375,-103.56460571289062,-104.35714721679688,-107.30281829833984,-107.7035903930664,-108.21565246582031,-108.97911834716797,-109.92417907714844,-111.90765380859375,-110.76831817626953,-109.38455200195312,-110.71717834472656,-110.99720764160156,-112.01936340332031,-114.81238555908203,-113.26318359375,-113.74188232421875,-114.55938720703125,-114.0682373046875,-113.9090805053711,-115.58585357666016,-111.71415710449219,-110.62107849121094,-111.70451354980469,-111.62154388427734,-110.91324615478516,-113.03437042236328,-114.60651397705078,-112.99722290039062,-113.88594055175781,-114.12223815917969,-113.109619140625,-114.44876098632812,-113.38973999023438,-112.4382095336914,-113.9791488647461,-114.70406341552734,-113.72392272949219,-116.61629486083984,-117.56817626953125,-116.63848114013672,-116.10496520996094,-118.16585540771484,-118.05354309082031,-117.46955108642578,-119.59271240234375,-118.85768127441406,-118.39897155761719,-117.40310668945312,-117.74433135986328,-115.53639221191406,-116.46163177490234,-116.06555938720703,-114.11866760253906,-114.14823913574219,-112.32255554199219,-113.79356384277344,-114.3716812133789,-116.7109375,-115.62095642089844,-112.92061614990234,-112.49696350097656,-113.49607849121094,-113.21310424804688,-114.9491195678711,-114.08853149414062,-112.97675323486328,-112.1059341430664,-111.8796157836914,-110.05721282958984,-110.77259826660156,-110.75086975097656,-112.44837951660156,-112.37191772460938,-113.16987609863281,-116.62201690673828,-115.83575439453125,-114.9211196899414,-115.89549255371094,-114.59341430664062,-114.42630004882812,-115.28840637207031,-116.22706604003906,-116.8581771850586,-115.24697875976562,-114.46182250976562,-114.95201873779297,-116.60877227783203,-119.53443908691406,-119.70155334472656,-118.36582946777344,-119.3558349609375,-119.95983123779297,-122.85917663574219,-120.12289428710938,-117.38914489746094,-118.28175354003906,-117.57875061035156,-118.25883483886719,-118.764892578125,-117.7842025756836,-118.11875915527344,-118.59215545654297,-118.65424346923828,-119.53755187988281,-120.55081176757812,-119.81634521484375,-118.29708862304688,-119.46173095703125,-119.39556121826172,-120.8547134399414,-119.96113586425781,-119.97859954833984,-119.58111572265625,-117.80815124511719,-120.27445983886719,-120.9256591796875,-119.95423889160156,-121.97281646728516,-120.78245544433594,-119.92623901367188,-121.21580505371094,-122.126708984375,-118.39496612548828,-116.56502532958984,-115.92818450927734,-118.49066162109375,-119.82489776611328,-120.00090789794922,-119.16618347167969,-117.45154571533203,-117.35026550292969,-118.28372955322266,-116.13804626464844,-117.27141571044922,-119.18879699707031,-119.0791244506836,-119.46247863769531,-121.82609558105469,-121.53855895996094,-120.94667053222656,-118.83854675292969,-117.100830078125,-118.00209045410156,-117.55839538574219,-119.38084411621094,-117.72795867919922,-115.82920837402344,-116.18336486816406,-114.36290740966797,-113.9113998413086,-116.49755859375,-119.9862060546875,-119.16153717041016,-117.98422241210938,-116.9731216430664,-119.80516052246094,-120.09949493408203,-119.29325866699219,-120.447509765625,-121.33102416992188,-121.44712829589844,-121.8168716430664,-121.61331176757812,-119.03479766845703,-119.781005859375,-121.60620880126953,-119.74163818359375,-118.54615783691406,-119.24785614013672,-119.72415924072266,-118.66131591796875,-119.05860900878906,-120.96321105957031,-120.33904266357422,-120.69733428955078,-123.30319213867188,-120.8705825805664,-119.99520111083984,-119.88993835449219,-117.95782470703125,-117.04898834228516,-120.44963836669922,-121.71024322509766,-122.08941650390625,-122.10037994384766,-120.08185577392578,-119.79228210449219,-120.90756225585938,-119.92652893066406,-119.11941528320312,-119.0164566040039,-118.59282684326172,-117.88399505615234,-119.25662231445312,-120.22230529785156,-120.39641571044922,-119.63542938232422,-119.76844787597656,-121.81320190429688,-121.03451538085938,-119.71320343017578,-120.94062042236328,-121.98603820800781,-123.27228546142578,-119.29012298583984,-119.77993774414062,-121.89644622802734,-122.70954132080078,-119.7816390991211,-118.96466064453125,-118.24342346191406,-116.573974609375,-116.13159942626953,-117.9385757446289,-119.48674011230469,-119.11749267578125,-119.82682037353516,-120.33939361572266,-118.52336120605469,-117.34487915039062,-118.34709167480469,-119.28489685058594,-119.2494125366211,-118.39022827148438,-117.50399780273438,-118.36917877197266,-119.55189514160156,-123.82275390625,-121.66165161132812,-122.873779296875,-121.0740737915039,-119.9110336303711,-119.70365905761719,-122.33535766601562,-124.36283874511719,-121.76112365722656,-120.83464813232422,-121.24365234375,-122.50224304199219,-122.24481201171875,-122.45985412597656,-122.86300659179688,-122.07768249511719,-120.87956237792969,-121.41688537597656,-121.13715362548828,-120.80943298339844,-118.49673461914062,-118.55828857421875,-121.0819320678711,-122.03335571289062,-122.41990661621094,-122.00454711914062,-121.60481262207031,-121.2989501953125,-119.5713119506836,-119.71487426757812,-121.2948226928711,-120.81434631347656,-119.27401733398438,-118.50907897949219,-121.24205017089844,-121.6458511352539,-122.26432037353516,-122.09052276611328,-119.04757690429688,-118.34649658203125,-119.47172546386719,-120.34648895263672,-120.39682006835938,-118.33052062988281,-117.06768798828125,-116.82829284667969,-115.9492416381836,-117.9496078491211,-119.30297088623047,-119.76089477539062,-119.65438842773438,-119.45722961425781,-120.78257751464844,-120.34134674072266,-122.70939636230469,-120.20889282226562,-119.85955810546875,-120.15657043457031,-118.91761779785156,-117.09522247314453,-117.178955078125,-117.94254302978516,-120.9854507446289,-123.11473846435547,-120.54835510253906,-119.77288055419922,-121.31659698486328,-117.84336853027344,-117.4887924194336,-117.85224151611328,-121.39678192138672,-120.58414459228516,-121.28173065185547,-121.59600830078125,-120.56414794921875,-118.37452697753906,-116.99898529052734,-117.99906921386719,-120.12478637695312,-120.67750549316406,-118.94442749023438,-118.67939758300781,-117.45297241210938,-117.84197998046875,-119.75857543945312,-119.34979248046875,-120.45751953125,-121.25311279296875,-119.24930572509766,-118.56616973876953,-121.0867919921875,-120.55924224853516,-121.56971740722656,-119.82514190673828,-118.18080139160156,-117.11479187011719,-118.01397705078125,-119.74173736572266,-118.52618408203125,-117.8331298828125];
  data = data.map(Math.abs); // This should work as Math.abs
  var response = worm.getMFCCs({
    fft: data,
    filterBanks: 10,
    minFreq: 300,
    maxFreq: 8000,
    sampleRate: 44100,
    toLinearMagnitude: false
  });
  var expected = [ 7.835884051228317, 1.1605377428549413, -0.174171119713941, 1.3509315849239385, -0.1991916156746527, 1.1153378031810444, -0.12527438596350143, 0.7039658412425222, -0.06616022000494146, 0.24848612991692026 ];
  deepEqual(response.map(_round), expected.map(_round));
  worm.destroy();
});

module( "peak height determination" );
test( "left peak", function() {
  equal(VowelWorm._peakHeight(0, [10,0,0]), 10);
});
test( "right peak", function() {
  equal(VowelWorm._peakHeight(2, [0,0,10]), 10);
});
test( "middle peak", function() {
  equal(VowelWorm._peakHeight(1, [0,10,0]), 10);
});
test( "unequal sides", function() {
  equal(VowelWorm._peakHeight(1, [5,10,3]), 5);
});
test( "not a peak", function() {
  equal(VowelWorm._peakHeight(1, [20,10,20]), 0);
});
test( "long right decline", function() {
  equal(VowelWorm._peakHeight(1, [0,50,40,30,20,10,0]), 50);
});
test( "long left decline", function() {
  equal(VowelWorm._peakHeight(5, [0,10,20,30,40,50,0]), 50);
});

module( "frequency finding" );
test( "_toFrequency", function() {
  equal(VowelWorm._toFrequency(0, 16000, 2048), 0);
  equal(VowelWorm._toFrequency(512, 16000, 2048), 4000);
  equal(VowelWorm._toFrequency(1024, 16000, 2048), 8000);
  equal(VowelWorm._toFrequency(2048, 16000, 2048), 16000);
});

/*************************/

module( "vs. Wavesurfer's LPC" );

function testGetFormants(data, sampleRate, expected) {
  var LEEWAY = 150; // amount to forgive, in Hz
  var worm = new VowelWorm.instance();
  worm.maxFormantHz = sampleRate/2; // trick it into resampling into the same value

  var formants = worm.getFormants(data, sampleRate);
  close(formants[0], expected[0], LEEWAY, "F1");
  close(formants[1], expected[1], LEEWAY, "F2");
  close(formants[2], expected[2], LEEWAY, "F3");
  worm.destroy();
}

/**
 * I'm removing this because it's breaking, and we're interested in MFCCs at
 * the moment.
 * TODO
 */
//test( "ae", function() {
//  var ae = new Float32Array([-22.727865,-30.058773,-67.662537,-63.230507,-67.310753,-71.779541,-68.448433,-78.303696,-79.491425,-71.479942,-65.038139,-74.566231,-77.874985,-65.987312,-52.824326,-45.969223,-20.430431,-13.396776,-20.753382,-47.290604,-49.735783,-70.647034,-62.081093,-66.290352,-62.086151,-59.665398,-62.687820,-57.307308,-81.834709,-54.252602,-57.606815,-45.986160,-40.408382,-18.851553,-12.251842,-19.870752,-42.000679,-45.383148,-57.405323,-55.963577,-60.921627,-58.019897,-64.523109,-76.344688,-58.201252,-58.769096,-54.627151,-57.758354,-51.887676,-48.358215,-24.801945,-19.375973,-28.285305,-48.922615,-50.965710,-63.758286,-55.098850,-72.276085,-57.518044,-62.350605,-60.798409,-59.691769,-63.360214,-51.548199,-54.117977,-42.488102,-38.531227,-20.431351,-14.606422,-22.012882,-39.454826,-41.213570,-57.218681,-47.644547,-57.313789,-47.037785,-52.444374,-57.722149,-47.647175,-48.319038,-43.040970,-41.333794,-38.856403,-35.793636,-15.436175,-11.408807,-22.468348,-34.632660,-36.547737,-47.984833,-44.855385,-46.040245,-46.561443,-43.838490,-56.313129,-48.703003,-51.053844,-44.448074,-38.742653,-30.421825,-25.842478,-13.021287,-7.564312,-15.849034,-30.923834,-34.823364,-44.067795,-43.370743,-58.492073,-47.379459,-65.135002,-51.431480,-45.906487,-58.919159,-45.508343,-47.707726,-47.673630,-46.046120,-27.891022,-27.233326,-39.809292,-43.895580,-49.746906,-54.576645,-53.111961,-51.439899,-67.635475,-47.976345,-55.703651,-57.006184,-66.859489,-53.463585,-51.529358,-44.801468,-38.618092,-27.224184,-23.275013,-30.473026,-46.171101,-46.093025,-53.172661,-59.474407,-58.390194,-65.240646,-58.906696,-61.972355,-56.540688,-52.714573,-55.535458,-52.750252,-48.892651,-48.912560,-32.249306,-31.294123,-48.708069,-55.173313,-58.315224,-64.298363,-55.481483,-62.600693,-61.871876,-54.813465,-62.508667,-66.910728,-68.250885,-59.765259,-53.312824,-43.721283,-39.601242,-28.460854,-25.828600,-34.129391,-43.571148,-46.071423,-52.450493,-52.187580,-56.815186,-57.118774,-63.124306,-59.158657,-53.606926,-52.155312,-50.517834,-46.049694,-44.561916,-46.597366,-29.356569,-28.569572,-49.466484,-45.900593,-51.296597,-54.413666,-54.226421,-56.207939,-61.042877,-49.511692,-57.328854,-74.629662,-65.304993,-65.577377,-42.548203,-35.769562,-31.319229,-19.867664,-18.980085,-29.109901,-34.638065,-38.529915,-41.396324,-43.963039,-48.330929,-50.333519,-49.423073,-54.267906,-46.272346,-46.065887,-44.952087,-35.725456,-29.932182,-30.547907,-15.432733,-16.786537,-32.958542,-33.055019,-34.288239,-39.436153,-42.701843,-58.637627,-50.816669,-44.610722,-44.273670,-47.153107,-47.661980,-45.265919,-41.279224,-33.102535,-34.840668,-25.919052,-23.316271,-28.870319,-37.088573,-42.877769,-49.070984,-52.847923,-51.607124,-52.037903,-55.759289,-50.031799,-47.310337,-49.114590,-47.980759,-43.395561,-37.687679,-49.887527,-26.400784,-28.594635,-38.479298,-43.937664,-50.532650,-62.202526,-57.405998,-56.286469,-58.437160,-58.778866,-61.991093,-59.734993,-61.730713,-57.915119,-49.013103,-44.450600,-39.590199,-28.904121,-29.635992,-39.553547,-42.366062,-48.149223,-50.218441,-78.059998,-55.831421,-55.882973,-57.157307,-57.399380,-56.024639,-53.891891,-53.622719,-46.674694,-42.370491,-48.724281,-30.077616,-31.873600,-42.733315,-46.560139,-53.099556,-56.459049,-56.799137,-61.152084,-66.865654,-65.439117,-56.437237,-72.334129,-69.180763,-57.547413,-52.275108,-46.363708,-45.186901,-34.381321,-35.491268,-43.958332,-46.629307,-48.837830,-52.106796,-61.366421,-56.450214,-54.238552,-59.301212,-60.050346,-61.339848,-61.916935,-61.897438,-51.527084,-46.250523,-59.307266,-34.035175,-37.383240,-44.978878,-52.087482,-53.373737,-51.360603,-49.036453,-56.503239,-63.731358,-54.132168,-52.265739,-64.423149,-63.108593,-55.361027,-47.264275,-43.033215,-43.510963,-34.642151,-36.177586,-43.986126,-45.045826,-46.736225,-47.615688,-55.515419,-53.650135,-53.279007,-57.200806,-60.525555,-58.982311,-63.798660,-73.160278,-54.349594,-49.714699,-56.670452,-38.843636,-41.270767,-49.759624,-52.816120,-70.630852,-56.964783,-56.518078,-65.642532,-61.572205,-69.358505,-62.653858,-69.644485,-62.417057,-62.849155,-54.851810,-48.053993,-50.827892,-39.796520,-41.308792,-48.717129,-50.268513,-51.534508,-53.022648,-56.508427,-60.388863,-59.717556,-63.930061,-65.187378,-69.228455,-67.826904,-64.807640,-57.624924,-51.517277,-59.717175,-41.728302,-44.548943,-49.833698,-55.237770,-65.888680,-59.274063,-66.393402,-65.804237,-66.131226,-67.576660,-69.414581,-75.749832,-60.407986,-61.578087,-55.160728,-49.882774,-51.831097,-40.101582,-41.936069,-47.764355,-50.441914,-55.197998,-53.593578,-56.484756,-60.814384,-56.129669,-62.686367,-85.611977,-62.119404,-60.457470,-54.381618,-51.460556,-44.364029,-47.813656,-35.567287,-37.682529,-42.561146,-46.476967,-54.320370,-52.053150,-52.770851,-57.782993,-54.911911,-60.013065,-77.788101,-61.586227,-67.794609,-54.301628,-51.217560,-44.656296,-48.376553,-37.802944,-40.456638,-45.339005,-49.735180,-56.443478,-54.891525,-59.289703,-64.513176,-60.917217,-65.557816,-71.510956,-91.846733,-79.947647,-70.141861,-61.294922,-57.979824,-55.644466,-51.585243,-65.767197,-64.709152,-71.931389,-69.509605,-74.509811,-70.008636,-69.389847,-82.130333,-75.024925,-72.549088,-79.685806,-84.797676,-68.857323,-65.615219,-59.925266,-63.653675,-52.642616,-55.269283,-59.341988,-63.021576,-65.808434,-64.469055,-82.283875,-78.935585,-66.718781,-73.105621,-70.413979,-70.636482,-69.442673,-77.565636,-65.675980,-64.812393,-59.206020,-60.259750,-72.786133,-75.879570,-70.898201,-75.934982,-71.542809,-68.206596,-80.560577,-84.106758,-70.542473,-73.703926,-73.068260,-75.149719,-68.375694,-70.081619,-61.846176,-67.670830,-57.896362,-60.738670,-64.091942,-73.478134,-69.100006,-74.162628,-70.727791,-68.613846,-78.138046,-78.834183,-76.596725,-74.857468,-79.622627,-71.940086,-77.130745,-83.978203,-72.354378,-66.423134,-65.959091,-77.858589,-82.807961,-76.849937,-77.741982,-74.068970,-79.117043,-71.831024,-73.794189,-68.091980,-65.598518,-68.743835,-63.158249,-58.826916,-55.056465,-59.966496,-52.919662,-57.547688,-59.144970,-58.377930,-59.097164,-61.989708,-61.259003,-64.270538,-77.006966,-63.739758,-59.956459,-58.625439,-68.536263,-67.353882,-55.761356,-49.686741,-54.185539,-43.824787,-46.897541,-51.206825,-59.173088,-64.260147,-61.114178,-57.931702,-63.826351,-70.126518,-67.037430,-72.501541,-63.082108,-63.061665,-55.536465,-52.842125,-51.895695,-55.613327,-53.058296,-59.178314,-54.754112,-55.932552,-57.852509,-59.419098,-65.150574,-63.155701,-73.366295,-75.015373,-65.773109,-65.848251,-65.617264,-64.201759,-60.087658,-60.143379,-65.197746,-54.308987,-58.830803,-63.493641,-72.533920,-72.831665,-71.629402,-78.889053,-71.980179,-77.177185,-72.560356,-75.785538,-70.668365,-73.122391,-66.202072,-65.139839,-65.165085,-63.238781,-63.720791,-65.502083,-67.902031,-68.940872,-71.553490,-75.057510,-75.212204,-82.400665,-76.662949,-79.403229,-81.470627,-82.302025,-81.658836,-71.727806,-79.114334,-69.162537,-71.926842,-70.363266,-76.077370,-70.523415,-76.701881,-76.392448,-76.546486,-77.078056,-88.436264,-76.923927,-85.428291,-78.380211,-78.076897,-78.978569,-81.424019,-76.423119,-77.818771,-81.880524,-71.879066,-76.240341,-83.651253,-81.859245,-81.645172,-78.684059,-79.238762,-77.970421,-85.380096,-78.804291,-83.799744,-79.808189,-80.830818,-76.545357,-81.748962,-75.862648,-75.413155,-91.832382,-76.631058,-80.497993,-83.088295,-78.764549,-81.768539,-79.508385,-82.390388,-77.617447,-84.366394,-83.985771,-79.620674,-80.551018,-78.193291,-79.800766,-75.343155,-90.340210,-75.855255,-78.121223,-78.347725,-83.966400,-78.019981,-77.820335,-83.896606,-77.364235,-99.393852,-77.503952,-79.001923,-78.779213,-77.911713,-81.387115,-72.240913,-76.714607,-73.282089,-72.004509,-70.021332,-77.464607,-76.762970,-90.979935,-73.034088,-85.600090,-75.238243,-82.861038,-76.439819,-77.136719,-90.301353,-87.841331,-76.055168,-68.281075,-68.273048,-67.668762,-76.196213,-68.819740,-71.123322,-69.794624,-70.033325,-79.702232,-71.911781,-81.892776,-69.861282,-82.496544,-81.955597,-81.724464,-76.052246,-68.867691,-71.769409,-67.267418,-69.130470,-71.406265,-70.958832,-67.319801,-79.658707,-71.138863,-77.048164,-72.928581,-79.427628,-77.246346,-77.894554,-84.467216,-77.888298,-74.015114,-75.603737,-68.894516,-70.028152,-72.887642,-73.566811,-68.407600,-70.988419,-72.633408,-70.434258,-69.968864,-80.134773,-72.500587,-74.422043,-73.107101,-71.425545,-77.497795,-79.503975,-76.031517,-67.809570,-71.960846,-67.364288,-69.504646,-70.156143,-68.812149,-70.234489,-69.698990,-67.808052,-73.103600,-73.895111,-71.575142,-77.957352,-70.899918,-75.110725,-78.768394,-68.570297,-63.134830,-65.282578,-63.827351,-66.206940,-75.883484,-66.807571,-71.349701,-67.952469,-67.399254,-69.136330,-72.690063,-67.439079,-65.174080,-66.727219,-76.869911,-69.481468,-60.539238,-59.156216,-62.411926,-58.671406,-57.954857,-61.651157,-58.676674,-63.325569,-63.131195,-64.893639,-63.653809,-65.164299,-73.967171,-66.394630,-62.269100,-78.051476,-65.742020,-61.020607,-56.234104,-63.531033,-56.667534,-54.692329,-59.833160,-58.919552,-59.964603,-62.998318,-61.288681,-64.137772,-68.804695,-65.902168,-65.499435,-66.814163,-73.341309,-63.899441,-56.545551,-54.214149,-62.227928,-54.186474,-53.545959,-53.257992,-57.082058,-58.758743,-63.189152,-75.747437,-61.747955,-57.553978,-80.264046,-63.076302,-61.310005,-63.739967,-57.915810,-58.817852,-54.245060,-60.616386,-54.499065,-54.721172,-56.199963,-62.264221,-66.030319,-66.080978,-78.936203,-62.376030,-61.625507,-67.250626,-74.386971,-73.295929,-68.770424,-64.025810,-60.069107,-59.138382,-61.223301,-58.553154,-60.496937,-57.706825,-63.207050,-78.293007,-70.731728,-68.454956,-65.323936,-72.780373,-71.055359,-75.689644,-69.686493,-72.256821,-68.209938,-70.008347,-63.007545,-65.048691,-64.229218,-64.430367,-67.259880,-69.872993,-80.490608,-67.607208,-68.910027,-72.049492,-68.496765,-77.854088,-72.737930,-78.754349,-72.532028,-68.515686,-72.807739,-63.041588,-72.143532,-67.725143,-66.052719,-61.963455,-68.994240,-69.161095,-69.205154,-65.989754,-68.830063,-67.579575,-75.787613,-77.186882,-75.574852,-77.008942,-70.081833,-75.137543,-65.920464,-69.304726,-64.443878,-67.427261,-63.898460,-70.133751,-71.984200,-68.282578,-72.848328,-66.432983,-72.689789,-76.233589,-67.697197,-67.995186,-76.567764,-68.580139,-66.893059,-65.790512,-75.243340,-63.575474,-63.789932,-61.253025,-64.997169,-67.645119,-64.130829,-73.327751,-70.635811,-69.532814,-75.825150,-70.009399,-77.036583,-75.453674,-67.277710,-68.567429,-68.307922,-73.844521,-67.251663,-73.609055,-66.984047,-71.108421,-65.981590,-67.101746,-73.704498,-68.754364,-71.734360,-75.555328,-71.884735,-72.405952,-70.710144,-65.670631,-70.617699,-66.364029,-69.044533,-67.754456,-73.911415,-64.445839,-77.221878,-69.061142,-70.256355,-73.198830,-89.075623,-71.179230,-106.654839,-73.816452,-77.620583,-71.582939,-78.443840,-72.654770,-69.267998,-75.048622,-70.262329,-76.907181,-80.351875,-76.329086,-79.161743,-71.878754,-84.775948,-73.379364,-81.783386,-82.290825,-77.686180,-80.204208,-77.477455,-75.565353,-72.536781,-74.558594,-72.141586,-73.189178,-78.197319,-80.875710,-78.476883,-81.302856,-73.911270,-79.643875,-80.124626,-81.908180,-79.109200,-84.885666,-77.025093,-89.397339,-81.015991,-76.824585,-78.119606,-76.854134,-81.045952,-79.170387,-86.369095,-81.080017,-77.227089,-86.322266]);
//  var sampleRate = 16000;
//  var expected = [768, 1698, 3340];
//  testGetFormants( ae, sampleRate, expected );
//});

test( "e", function() {
  var e = new Float32Array([-22.751581,-29.904552,-64.712555,-62.556587,-63.883247,-60.994946,-63.680157,-65.801491,-62.551941,-59.903847,-62.620274,-59.942337,-59.719837,-60.965294,-58.638870,-51.847683,-36.634651,-17.456884,-9.916006,-17.379951,-34.817200,-66.199501,-54.522575,-53.861187,-54.557571,-53.139038,-56.764130,-56.309002,-50.039433,-54.756226,-56.815567,-50.723618,-54.366703,-39.691704,-26.727259,-12.755235,-5.738704,-12.873478,-24.703114,-53.623192,-45.658890,-46.011856,-46.883766,-41.754852,-42.637581,-44.606255,-41.080879,-45.528416,-52.186066,-43.326923,-45.974869,-33.562588,-21.862846,-10.055400,-3.492637,-11.523376,-17.928528,-44.801376,-48.665588,-43.779736,-43.478840,-46.647991,-44.613415,-46.797493,-47.030102,-46.950047,-52.334484,-47.232269,-62.278172,-34.069157,-25.513939,-16.915194,-11.670132,-17.677219,-26.179222,-44.404331,-61.797386,-51.686939,-53.801960,-44.356045,-45.121120,-48.285927,-47.649776,-51.905167,-57.798317,-54.853409,-51.793781,-46.388172,-36.529846,-30.681587,-26.942648,-34.012077,-37.982445,-71.757820,-59.135517,-57.268185,-72.027733,-50.649288,-50.583038,-59.811066,-57.121841,-55.727032,-62.315704,-62.042801,-59.195946,-62.481861,-52.613548,-41.761246,-35.870327,-39.377930,-45.022629,-53.712677,-59.523315,-61.368145,-64.822617,-59.200409,-58.126694,-58.938931,-66.889641,-61.881767,-61.333061,-79.955154,-58.059677,-52.063438,-45.595787,-39.410313,-37.871323,-45.691803,-44.416737,-67.532097,-61.353363,-59.869572,-62.365364,-58.412163,-54.064754,-58.242474,-66.121124,-60.237167,-61.127792,-65.359055,-60.613659,-56.186218,-46.868488,-41.990105,-38.764774,-45.751152,-45.140537,-54.403763,-65.053474,-64.294792,-64.106224,-71.585129,-67.350525,-60.644714,-64.145134,-72.073952,-66.426727,-69.272644,-64.379211,-53.079487,-48.640541,-44.329918,-44.686218,-58.508305,-49.832184,-68.588295,-63.516716,-64.306732,-61.404278,-60.393322,-58.585159,-58.109867,-59.565517,-66.113289,-61.503124,-70.625954,-58.950954,-55.330128,-49.276859,-44.698605,-42.620499,-46.585350,-45.799351,-53.954166,-58.228523,-72.353638,-61.722843,-60.228951,-68.328651,-59.712307,-59.178085,-66.845551,-70.398598,-66.469933,-67.456665,-54.210781,-47.106152,-44.318398,-44.172344,-59.475330,-47.014561,-55.943043,-59.693802,-59.824688,-60.105522,-58.629829,-57.051300,-56.640503,-58.081059,-62.177681,-64.689316,-65.062981,-62.072063,-53.732605,-50.899136,-48.094032,-46.036701,-47.205441,-46.262848,-51.678623,-51.705223,-62.131245,-63.623013,-59.114235,-66.209122,-65.197258,-58.384705,-65.257614,-97.219254,-62.247616,-64.548302,-55.458870,-48.261082,-45.385937,-46.413776,-55.477913,-47.338005,-58.258884,-54.379639,-53.451443,-58.569904,-54.255344,-51.783916,-53.049099,-53.793583,-53.730877,-60.144520,-53.771225,-51.613953,-44.999191,-40.069401,-37.843060,-37.954659,-44.455582,-35.579964,-44.091156,-39.396286,-44.790997,-55.519779,-54.356552,-54.287769,-59.597889,-55.085201,-52.901081,-52.453941,-44.308079,-37.909737,-30.917477,-25.953075,-23.550097,-25.939861,-34.393974,-24.266703,-36.727856,-29.732704,-31.754456,-44.105545,-37.805813,-34.979481,-38.261532,-36.291637,-36.723862,-42.048317,-37.738430,-33.974705,-29.153852,-25.642897,-24.300640,-26.146845,-33.955734,-30.311028,-36.761539,-36.691509,-47.908905,-45.762978,-41.454975,-38.705681,-40.374126,-39.543583,-44.831997,-63.058727,-53.214764,-68.186325,-40.660126,-33.610889,-30.067217,-31.738964,-46.063164,-34.569962,-47.741127,-39.976307,-38.338486,-43.767384,-39.769093,-38.802334,-40.138535,-41.794926,-46.261906,-50.575901,-47.564152,-44.835632,-38.399212,-35.318302,-36.003628,-41.434189,-39.737198,-33.587013,-38.649094,-38.705959,-42.033623,-50.772949,-45.134384,-45.057907,-50.455860,-49.009045,-48.532513,-70.753075,-47.995037,-42.793911,-48.730358,-44.007523,-38.474979,-36.601715,-43.560875,-37.210999,-42.560318,-37.768398,-42.565170,-44.774128,-41.940357,-44.538452,-42.430485,-43.507854,-50.404945,-50.811954,-44.548950,-41.454254,-40.819420,-39.477840,-40.932232,-59.683304,-44.451984,-38.595058,-42.283634,-44.628197,-45.003098,-50.712196,-41.875324,-44.943745,-45.303391,-46.694836,-55.697342,-58.287151,-52.549328,-49.596725,-46.392887,-41.669243,-41.700546,-45.994160,-48.463291,-44.965385,-49.877930,-45.161331,-53.300278,-48.368877,-71.920677,-49.215919,-53.585182,-58.350075,-52.178822,-48.113319,-42.866772,-39.219604,-37.438988,-36.342880,-39.458065,-57.406631,-40.759098,-41.575848,-66.080605,-48.318703,-51.318588,-49.475361,-46.524338,-56.188046,-51.494888,-49.269581,-52.333172,-50.263809,-45.341888,-42.831734,-41.199066,-39.306870,-41.055183,-50.833321,-41.711586,-40.838932,-54.120167,-43.620537,-47.903030,-44.702656,-51.755478,-50.456612,-56.405888,-59.229637,-53.108070,-51.146366,-45.488445,-42.539688,-40.011009,-38.162792,-42.396320,-71.265800,-43.341076,-41.287464,-51.343872,-47.708054,-53.433685,-49.338589,-46.705124,-52.780071,-53.250317,-52.112106,-56.606281,-58.233784,-51.479996,-50.773102,-48.698185,-43.202972,-42.948372,-50.460335,-46.263283,-40.915516,-53.826607,-42.713154,-62.197018,-43.424736,-65.569069,-52.857399,-54.038067,-58.770435,-60.349094,-55.599918,-52.160858,-49.613251,-51.019196,-52.963947,-56.293156,-58.622711,-57.142059,-59.453106,-59.170708,-62.437157,-69.537659,-68.469345,-66.155449,-72.327026,-70.431427,-79.433899,-74.465858,-75.420815,-68.536308,-67.518173,-66.415993,-64.651169,-71.907791,-100.007988,-73.294807,-76.671341,-74.568977,-95.060455,-82.959625,-79.182945,-77.884361,-81.781677,-86.206818,-79.995621,-86.869598,-78.600189,-84.479141,-74.715179,-73.426903,-76.740479,-75.623192,-76.678253,-80.810547,-78.075401,-87.659264,-78.848198,-76.231140,-82.678879,-82.707085,-75.660431,-77.212029,-116.496819,-80.094948,-81.022209,-80.788971,-77.314064,-89.403839,-77.640907,-78.908302,-77.428658,-83.749550,-79.409866,-74.932320,-88.518867,-81.674942,-72.864464,-75.440742,-80.439964,-69.377953,-83.305634,-78.520966,-80.008308,-73.139420,-69.598640,-62.662792,-60.105469,-63.976978,-70.211380,-65.854797,-62.033329,-58.476688,-66.862846,-59.414291,-58.002293,-65.770142,-61.330456,-73.470871,-60.264759,-57.022148,-56.593613,-53.273678,-50.656387,-50.414276,-57.683224,-60.446968,-55.753551,-62.216026,-55.831100,-63.628246,-56.941586,-64.485657,-58.746761,-58.581940,-67.302116,-57.770905,-62.954872,-65.393272,-61.166512,-58.692692,-60.981297,-72.763176,-62.918968,-58.294140,-62.063171,-71.964966,-66.270645,-67.012047,-64.798775,-73.017082,-61.428604,-73.647919,-71.751648,-70.808296,-76.499046,-78.645958,-71.697174,-68.519432,-79.291870,-75.399635,-73.174599,-69.346909,-78.092293,-83.079933,-69.747147,-70.270966,-73.869873,-70.726250,-72.201447,-84.417435,-74.160347,-76.175476,-76.631157,-76.975204,-72.431610,-71.728951,-72.801079,-71.993317,-76.636086,-71.591309,-70.473213,-80.263275,-69.057388,-73.998894,-74.772087,-72.728119,-69.602272,-75.971062,-96.121719,-72.974174,-74.062538,-72.146935,-67.917328,-68.192055,-69.457184,-75.568733,-72.728134,-66.915207,-68.493050,-82.093880,-74.970985,-71.137131,-73.375656,-78.465637,-67.554024,-77.376320,-68.040024,-70.468773,-75.646095,-78.114761,-72.817932,-70.422180,-71.701622,-72.250267,-87.494499,-84.092995,-73.362022,-81.901115,-75.130630,-73.378937,-84.547585,-75.834206,-77.203568,-81.855263,-80.390671,-75.455887,-78.674141,-71.806702,-72.922798,-66.091194,-66.467140,-70.412476,-72.426018,-66.229317,-69.451012,-75.829849,-78.298897,-68.355713,-69.359383,-76.514206,-70.232124,-67.512299,-67.694572,-66.168900,-67.336769,-70.441162,-67.184959,-64.465385,-69.522125,-88.695343,-69.974533,-67.573112,-70.657532,-75.233444,-69.479828,-66.972527,-67.280891,-76.045509,-74.709198,-79.141403,-78.300880,-73.493965,-77.799377,-76.848488,-76.786987,-73.201149,-66.820099,-68.055138,-70.373878,-74.647560,-69.091377,-69.841797,-71.376289,-65.951492,-72.305222,-70.966400,-80.929771,-70.853905,-72.222389,-70.361595,-72.522255,-75.459541,-78.917404,-68.994011,-68.861298,-73.335396,-74.922783,-66.614189,-71.515236,-74.635559,-77.230377,-71.403351,-64.501152,-79.636269,-66.643822,-64.393280,-75.183296,-67.191399,-69.090668,-74.175652,-77.165871,-67.321617,-65.571541,-61.894855,-63.363976,-70.043274,-63.372917,-64.673088,-64.539749,-62.733387,-63.197067,-65.441544,-66.918335,-66.473213,-62.193275,-70.016724,-76.717911,-68.108505,-70.312653,-64.451401,-64.286964,-63.342793,-62.325962,-66.456001,-64.473557,-69.210930,-67.792221,-70.560684,-66.867226,-67.769730,-76.767723,-61.964054,-67.320541,-72.462067,-72.955544,-68.481903,-66.577759,-66.783394,-67.235428,-70.135094,-75.422760,-77.327644,-67.606316,-77.924767,-78.344475,-78.143669,-66.869789,-68.428818,-66.381554,-66.319588,-58.362911,-62.760319,-67.176720,-56.574371,-56.987583,-56.262627,-61.638588,-67.698227,-57.735771,-59.115566,-58.614788,-70.111160,-62.036671,-60.880661,-64.487968,-62.393372,-66.415558,-57.338341,-58.307652,-68.119522,-74.916901,-58.640602,-56.696899,-57.763229,-56.034935,-54.145355,-57.500412,-72.697189,-61.337734,-64.338799,-85.912491,-73.172661,-65.596436,-66.449303,-63.939655,-68.808182,-67.379631,-66.725021,-72.098068,-76.043419,-71.706841,-65.639160,-70.528900,-72.924278,-72.668602,-74.801926,-75.286423,-76.767319,-76.345673,-75.438316,-78.995125,-87.592781,-77.402405,-79.745216,-79.540321,-103.557991,-76.611320,-98.755013,-78.144249,-84.223892,-82.540802,-82.186111,-76.121529,-87.664062,-85.054222,-85.454582,-83.015312,-80.828926,-81.881073,-79.610542,-85.216011,-78.361115,-92.464531,-82.078812,-79.557274,-87.732811,-83.400154,-82.736717,-84.790733,-88.966072,-85.194000,-81.709167,-83.026886,-83.240631,-84.324020,-82.950714,-83.285881,-88.375122,-85.260826,-83.203331,-82.858101,-92.849586,-81.314056,-91.398560,-80.791275,-86.100967,-82.958290,-88.251984,-84.242317,-83.738708,-83.619644,-89.191559,-83.849739,-82.737648,-86.483269,-85.718224,-86.724731,-82.948189,-81.935303,-83.167679,-88.099518,-82.692833,-81.907562,-81.560204,-84.705330,-80.607864,-80.930794,-83.166435,-80.302437,-79.153709,-78.884583,-93.110466,-78.499046,-81.783875,-76.037216,-73.592186,-79.193962,-79.432800,-79.003082,-73.408554,-72.668648,-76.009544,-79.070564,-72.208961,-74.528427,-77.188705,-81.412285,-75.649017,-79.625626,-72.325142,-75.862396,-87.450661,-74.730888,-74.355240,-74.616043,-81.856491,-79.122498,-80.255295,-71.906906,-74.551048,-71.796768,-77.234177,-77.915550,-77.588150,-70.480377,-72.907578,-83.499046,-75.769966,-71.526352,-72.876862,-81.983192,-70.435539,-67.556725,-71.940704,-90.381042,-73.905212,-72.331322,-71.259865,-81.976761,-73.598251,-77.088280,-72.111916,-78.303917,-76.690079,-80.026482,-86.273186,-71.096619,-79.002457,-76.423912,-69.383789,-71.337402,-76.866776,-79.049011,-74.526688,-72.477631,-72.245270,-68.246552,-76.131561,-95.216949,-76.664268,-69.243584,-72.521500,-70.742630,-70.834305,-72.057098,-73.351044,-77.240471,-75.622566,-65.370331,-74.109848,-85.587730,-80.419884,-69.112648,-71.063255,-79.788979,-77.793571,-77.474663,-74.501999,-77.350586,-79.099197,-75.888176,-80.277435,-71.779518,-84.275673,-85.755043,-76.392380,-80.542206,-78.445763,-83.032349,-76.523315,-91.433739,-84.061073,-77.664658,-91.090996,-81.492500,-81.640129,-81.993614,-95.975571,-84.108063,-83.612457,-80.535316,-87.424789,-88.571487,-81.997543,-81.175560,-89.995850,-80.234993,-82.286354,-75.529518,-81.009995,-86.775841,-83.926926]);
  var sampleRate = 16000;
  var expected = [392, 2165, 3352];
  testGetFormants( e, sampleRate, expected );
});

test( "i", function() {
  var i = new Float32Array([-22.760195,-29.835520,-60.569557,-60.596878,-60.652573,-62.206074,-60.534294,-57.513771,-59.346436,-57.534599,-63.168388,-56.435570,-59.723595,-59.452808,-59.657951,-53.920952,-64.670624,-42.707214,-15.022525,-9.527356,-18.849127,-46.120461,-57.456837,-74.962090,-64.670280,-58.556126,-65.223747,-58.639637,-61.570171,-60.997555,-54.164185,-51.251087,-54.400661,-62.369602,-44.249413,-47.961731,-27.689486,-8.013155,-4.295283,-15.579971,-40.571293,-53.298981,-50.133762,-57.587490,-55.435848,-54.234905,-54.586723,-58.156090,-57.941502,-58.406876,-60.722084,-59.477840,-60.027031,-61.309452,-58.793941,-45.641251,-30.643000,-29.033613,-44.718651,-58.385620,-61.853882,-61.390160,-60.723709,-64.902657,-63.372162,-62.199036,-65.114586,-70.733459,-60.322960,-65.055061,-63.053173,-65.276421,-75.224373,-62.408169,-50.751335,-38.878220,-37.759754,-56.848648,-75.963455,-66.293991,-64.343513,-65.336983,-67.208923,-65.602440,-67.906876,-66.310455,-70.623825,-60.142365,-66.440422,-73.067421,-67.481781,-67.688858,-75.982124,-53.673550,-43.199024,-45.580826,-63.969261,-88.203812,-67.452370,-68.380707,-70.160568,-72.808105,-69.536469,-71.523621,-70.604454,-77.085106,-66.316856,-71.410439,-74.495155,-69.523605,-75.360672,-70.967598,-62.019375,-58.931572,-58.303257,-80.254875,-73.558128,-73.104294,-69.999557,-76.373146,-71.360664,-70.115707,-72.493134,-73.429169,-75.355652,-72.071915,-68.996613,-76.025230,-73.102821,-70.365227,-68.846695,-57.276905,-47.518394,-53.941402,-67.506813,-74.386063,-71.304390,-73.958557,-78.318901,-71.882607,-79.457962,-72.683388,-73.883255,-75.223198,-74.227844,-76.606552,-72.241425,-79.339401,-73.014816,-69.478790,-58.728901,-52.121506,-59.372353,-67.471008,-70.629982,-76.351654,-74.269302,-73.049942,-78.931969,-76.699242,-73.562469,-74.909851,-73.270378,-79.404671,-75.579582,-73.034752,-80.479713,-75.378883,-74.377823,-61.627254,-58.644356,-64.760376,-69.611130,-75.264473,-77.377022,-74.599243,-74.971855,-79.785469,-73.643845,-80.633980,-74.695129,-77.296875,-72.927811,-81.050140,-74.848152,-74.675369,-80.838638,-68.193367,-57.423080,-56.962799,-62.996635,-71.708832,-72.082893,-79.986549,-76.637436,-72.876083,-79.622177,-74.513474,-78.568207,-75.618057,-75.284767,-77.803871,-75.457947,-84.342270,-74.583237,-73.948349,-76.509399,-60.708096,-62.142403,-68.496071,-77.008789,-79.175331,-73.802261,-81.195740,-76.971123,-75.490616,-79.283234,-77.823738,-77.469917,-77.736031,-75.804810,-78.890656,-77.384438,-73.546814,-71.983452,-63.107052,-53.086788,-53.482037,-62.364330,-85.721184,-78.165779,-78.388565,-79.036110,-77.240791,-85.273155,-75.359497,-76.345291,-78.785606,-79.057724,-76.305992,-84.020996,-74.207855,-85.015594,-71.521210,-58.647240,-51.977947,-52.996002,-64.125412,-74.360672,-80.408157,-75.293510,-74.480896,-86.771484,-74.161118,-74.920761,-79.763000,-77.796616,-71.600647,-86.567589,-78.699440,-70.463234,-76.949600,-66.406487,-50.743885,-43.913532,-46.628784,-55.178398,-76.759544,-75.453041,-73.460167,-70.631775,-75.185623,-72.781975,-78.987755,-75.869606,-73.437172,-71.802788,-73.292206,-81.030022,-65.864655,-65.673607,-55.364697,-43.338203,-37.621685,-42.843204,-49.723854,-57.444881,-59.644306,-67.408081,-64.530876,-63.135967,-71.595047,-72.076561,-74.052048,-64.820297,-60.849468,-61.659058,-65.384491,-57.640682,-58.253361,-45.171162,-34.084679,-29.556095,-36.450397,-41.549942,-50.915001,-55.146339,-56.881813,-57.305851,-64.172844,-54.981903,-61.862118,-59.707123,-69.788368,-63.586994,-62.180298,-57.933594,-57.932873,-58.748531,-45.568516,-38.650906,-36.871193,-45.572624,-51.258778,-56.698643,-69.476120,-70.720985,-74.692329,-69.916290,-68.706879,-71.470428,-75.149475,-82.455345,-68.500259,-73.324715,-65.713921,-62.598869,-63.585491,-48.786957,-39.800377,-38.311722,-46.304173,-53.029171,-58.233688,-75.929237,-69.311424,-66.781616,-70.899338,-72.696297,-67.668510,-91.155128,-74.340782,-66.439812,-79.309021,-71.415611,-68.637848,-66.570229,-51.628876,-42.345509,-41.887371,-49.475269,-55.704430,-60.540241,-63.840961,-73.884453,-66.160057,-64.128983,-60.231251,-69.233879,-82.735718,-80.967377,-68.065018,-69.917213,-69.863335,-62.847950,-55.561832,-44.110943,-37.721428,-38.690773,-44.504036,-55.592823,-54.290230,-60.495899,-70.726868,-65.183792,-65.108078,-65.034027,-74.110497,-76.776749,-75.292305,-63.712723,-72.115044,-66.854843,-63.977390,-51.880081,-39.430233,-33.245911,-36.201828,-40.333599,-52.303066,-49.460831,-57.444550,-61.731365,-58.337170,-57.356312,-59.673233,-70.861702,-73.452354,-64.311073,-60.088314,-56.798756,-51.713371,-51.494801,-38.780159,-29.058102,-25.054464,-30.072872,-32.707790,-47.632126,-43.254856,-48.329193,-53.969387,-51.848999,-58.064316,-66.865532,-59.155544,-91.360825,-56.075672,-55.328522,-61.832153,-57.435909,-52.819927,-44.548649,-37.751064,-35.581028,-43.710907,-44.370266,-51.699516,-60.647625,-60.963673,-65.155960,-65.436928,-56.368946,-60.553581,-59.880997,-65.239120,-56.990326,-58.119610,-59.173725,-53.587502,-50.189445,-39.151203,-33.014111,-32.509514,-42.362667,-42.317093,-57.582909,-59.901688,-67.798622,-67.027527,-69.797554,-65.810555,-67.382881,-74.834740,-87.574562,-66.153175,-69.480499,-67.667702,-60.185284,-57.435768,-45.134640,-38.874313,-39.100536,-47.299995,-46.891109,-54.234901,-56.262997,-71.997490,-68.001381,-69.347015,-65.568909,-68.955223,-72.959900,-69.512558,-85.958305,-79.383385,-66.605186,-74.827141,-72.185516,-73.853157,-58.470455,-59.047657,-53.366817,-54.050705,-71.354691,-60.830410,-64.604538,-66.273872,-65.722420,-64.697365,-76.036308,-92.065331,-69.695908,-72.382484,-83.873604,-72.014679,-67.382401,-65.370850,-54.824009,-50.239262,-52.803959,-61.182262,-56.520687,-64.028671,-69.956604,-64.320572,-76.458130,-65.269157,-65.602142,-90.253532,-67.926353,-70.136040,-68.507278,-76.955956,-73.292061,-64.952034,-61.454124,-52.332897,-48.262280,-54.194656,-53.891693,-56.485889,-68.432655,-68.966064,-68.786301,-71.804962,-66.387917,-71.300491,-89.977249,-69.621254,-85.986984,-84.024727,-70.664825,-73.256836,-72.662086,-71.356277,-67.194824,-62.515068,-65.882080,-62.599262,-76.234741,-75.378181,-76.110458,-87.801064,-77.890846,-75.069626,-75.294746,-73.410240,-73.623779,-78.978012,-72.435936,-79.715248,-69.588425,-64.959000,-57.372345,-53.207302,-50.288155,-56.189953,-58.119934,-65.096222,-78.434914,-73.737106,-69.301880,-69.597694,-62.767578,-66.960358,-68.746979,-69.473106,-79.781952,-79.263962,-74.290810,-77.974144,-73.593323,-64.591499,-63.054646,-63.465118,-67.925346,-66.285095,-77.134781,-72.846321,-80.649437,-77.960266,-81.374840,-76.319527,-78.436699,-74.748047,-78.285843,-88.116112,-78.157066,-89.861977,-81.277260,-86.526382,-68.061249,-64.587906,-63.071159,-73.052704,-70.904472,-78.200249,-81.344421,-82.361801,-82.520149,-86.581375,-85.880363,-79.704475,-78.882156,-76.319351,-86.584229,-84.684402,-76.415543,-91.056496,-88.225174,-70.791260,-70.458717,-73.215355,-77.736160,-72.812691,-75.227356,-81.710152,-90.711586,-83.450127,-79.407455,-80.850403,-81.972588,-90.021339,-74.287254,-84.787903,-84.314865,-81.431900,-78.508263,-88.481789,-64.951653,-60.245846,-59.378284,-65.713814,-67.192032,-71.940758,-85.005951,-76.630402,-81.576744,-76.868355,-80.468208,-78.250420,-69.868126,-68.733513,-77.946312,-77.122963,-73.364967,-68.312004,-70.200233,-68.002953,-65.500580,-70.071838,-64.953941,-74.009148,-74.180183,-71.340958,-77.818138,-83.890182,-83.750656,-79.281464,-78.963272,-68.765564,-67.682304,-82.036568,-75.263969,-70.566154,-71.229935,-67.764183,-65.013672,-61.610100,-62.535912,-66.706909,-80.507523,-77.295547,-75.765694,-75.964485,-78.363571,-75.049988,-83.506111,-71.403786,-73.573219,-71.591713,-76.698265,-75.559036,-82.517082,-77.175606,-66.561401,-61.984158,-61.530304,-67.891563,-66.659470,-73.345665,-68.037407,-69.768646,-72.647285,-72.207962,-73.689064,-74.372055,-69.704582,-75.278511,-76.770760,-75.026436,-76.787750,-72.100021,-69.160271,-59.502575,-54.234779,-53.726627,-59.230297,-64.544975,-64.294395,-64.034157,-70.416153,-78.580673,-72.128998,-75.296021,-76.398140,-66.754768,-69.506111,-77.409454,-67.907478,-73.074783,-77.305695,-85.933113,-67.687820,-60.408779,-61.998718,-74.017441,-64.518250,-65.972000,-72.582794,-70.908028,-72.555305,-76.608482,-86.518608,-73.977776,-74.218666,-75.089325,-80.799278,-73.916534,-73.505562,-78.545097,-74.676422,-65.737541,-62.980690,-65.466255,-70.594742,-71.185135,-78.019905,-80.854568,-75.479095,-81.826797,-78.673195,-80.703278,-74.004883,-80.764885,-82.987961,-77.854012,-78.421616,-82.923264,-80.700279,-88.629776,-86.310379,-75.309021,-75.116798,-66.609787,-64.175133,-69.007698,-78.314590,-88.058983,-69.751305,-75.979935,-70.569221,-70.334366,-79.404243,-75.347267,-66.159065,-63.954887,-66.059578,-69.900879,-62.216461,-56.811203,-55.360435,-56.963310,-62.107662,-64.763191,-72.657059,-80.485893,-70.741478,-72.340309,-73.660202,-72.839317,-71.652428,-79.350822,-76.549545,-81.827103,-76.218094,-75.146996,-80.165237,-80.688110,-70.777184,-74.369080,-74.055016,-73.080353,-72.279610,-83.519402,-81.117058,-94.382820,-83.016533,-88.626175,-82.664406,-90.010979,-82.315460,-95.041061,-83.330521,-85.926697,-88.688011,-84.051147,-94.717972,-82.414787,-82.303062,-89.967964,-87.030449,-85.098816,-86.454575,-85.377686,-85.602180,-86.735558,-85.148300,-88.955574,-84.818504,-85.514816,-87.914032,-84.835945,-86.664467,-85.447937,-87.298820,-91.851334,-74.953842,-84.061661,-83.189865,-81.381485,-93.608971,-86.542732,-79.746742,-83.883987,-81.464455,-99.251762,-82.823860,-89.649940,-97.884071,-79.031654,-99.342239,-80.112617,-99.046593,-80.899818,-80.312767,-72.145424,-78.885590,-73.166702,-74.624947,-81.779716,-86.532532,-74.500847,-89.391670,-76.124008,-83.975388,-79.865089,-91.383865,-84.947929,-75.556824,-77.373016,-80.443794,-82.797310,-83.801414,-74.987350,-67.252098,-69.462883,-71.128105,-73.475906,-89.747849,-70.329300,-67.367935,-83.935738,-70.977600,-90.983307,-73.194290,-75.382851,-73.464844,-68.863686,-72.860619,-70.267067,-82.596352,-72.769836,-71.898407,-70.399185,-77.048264,-69.508751,-69.483315,-101.015602,-79.423355,-74.827133,-89.720802,-78.306496,-88.586494,-73.742279,-79.733917,-79.844299,-78.912430,-78.167076,-77.264893,-78.215050,-82.632706,-84.064262,-80.236343,-89.590088,-78.504105,-107.514603,-101.404037,-82.426392,-83.107300,-79.635376,-85.699623,-86.766106,-83.391975,-80.773865,-86.944939,-85.557068,-78.016991,-84.777573,-79.731468,-78.043526,-79.662910,-75.363098,-82.355881,-84.014328,-89.144417,-88.524834,-79.879074,-90.335327,-83.531807,-85.887039,-81.698753,-85.957680,-84.680969,-79.944405,-87.755051,-73.811615,-80.552628,-82.034172,-78.504013,-74.660538,-72.136009,-81.392395,-83.254532,-83.826141,-85.835426,-91.757133,-92.255264,-81.411179,-88.927910,-81.695518,-93.199326,-85.989449,-86.347694,-86.821442,-85.078735,-91.710243,-83.809784,-83.895294,-93.940956,-83.313850,-89.979530,-85.092300,-87.104576,-82.542236,-96.586807,-84.955475,-88.779640,-85.075851,-90.155457,-85.171547,-88.503113,-86.275742,-86.348770,-87.507736,-87.154076,-88.059761,-87.323967,-87.038406,-87.813156,-87.092262,-85.574341,-87.380829,-90.912506,-86.216187,-88.437408,-85.658325,-88.739563,-86.141159,-89.278076,-86.368958,-87.186783,-89.674095,-85.443886,-87.105034,-89.470955,-85.736145,-87.253395,-89.365868,-88.745232,-84.869926,-87.997337,-88.349030]);
  var sampleRate = 16000;
  var expected = [296, 2346, 3227];
  testGetFormants( i, sampleRate, expected );
});

test( "u", function() {
  var u = new Float32Array([-22.684347,-29.996208,-75.674065,-67.325615,-72.491188,-65.815720,-64.690445,-66.157463,-57.824650,-66.296524,-63.161659,-57.908325,-61.500683,-56.537674,-57.910877,-57.326473,-58.281754,-46.935513,-25.964348,-12.257083,-13.975341,-37.692238,-46.926308,-55.237610,-52.800522,-49.561016,-52.210739,-52.666550,-50.634754,-52.785126,-54.301048,-52.673840,-48.745438,-56.010128,-46.848835,-47.862385,-35.816338,-27.246277,-7.549127,-3.700239,-15.598690,-29.639055,-46.332794,-47.633820,-53.096012,-49.463177,-56.042965,-50.756008,-54.275856,-57.917545,-54.821648,-54.938759,-59.149887,-54.246056,-58.574730,-55.950970,-54.486282,-39.934795,-29.718170,-34.138607,-56.570778,-54.842327,-67.925056,-59.592018,-72.096687,-57.605198,-59.531940,-56.880043,-71.267639,-59.449184,-61.580994,-60.386684,-64.876717,-58.235111,-77.513596,-48.991814,-39.257362,-25.856726,-25.334913,-46.649235,-44.771915,-55.219849,-57.728542,-56.503582,-56.818260,-66.314735,-51.059921,-72.468658,-59.732376,-54.580105,-62.105648,-89.702507,-60.709160,-47.209698,-47.123299,-37.679321,-24.734175,-21.067606,-29.970446,-38.944096,-44.604450,-71.378517,-58.849812,-53.757538,-63.945255,-63.620323,-64.657257,-58.572792,-60.930336,-66.398117,-61.280472,-69.383194,-58.640724,-71.772614,-58.014992,-48.621799,-40.886879,-44.259327,-64.068024,-64.708771,-66.976303,-72.702682,-62.250111,-71.503410,-66.438240,-61.612057,-71.808571,-91.376343,-65.797791,-65.971886,-68.554092,-68.640640,-68.892723,-70.632828,-67.165535,-57.302109,-54.968277,-71.356293,-74.035233,-65.588425,-81.521530,-69.111031,-70.493126,-64.964775,-76.932480,-67.392441,-84.827698,-65.359047,-71.720184,-71.079063,-72.743332,-64.617722,-78.598534,-70.382126,-70.131195,-72.089661,-67.895164,-73.613129,-70.566429,-75.990929,-71.401138,-70.181587,-78.360046,-67.037399,-74.854347,-73.456154,-70.293472,-85.064751,-68.706032,-77.237717,-68.978256,-68.603981,-72.509415,-68.369278,-57.123627,-61.298199,-67.678658,-70.260925,-70.572159,-75.107124,-71.655602,-81.481491,-67.890640,-70.860580,-78.689774,-69.161987,-70.651451,-69.738724,-74.033752,-73.215454,-71.625481,-77.188988,-72.546638,-65.024368,-69.246269,-67.578697,-72.337997,-76.265770,-76.379456,-75.666077,-71.454865,-74.336281,-73.803429,-74.583199,-78.588966,-70.801971,-76.239670,-72.730324,-78.651451,-72.385101,-78.913017,-75.491844,-67.512054,-67.373367,-67.858978,-74.249863,-79.367935,-77.268135,-74.802757,-76.615807,-76.727234,-75.188652,-72.763565,-76.206451,-70.139473,-80.529892,-73.388222,-79.950607,-73.035004,-76.302544,-72.296059,-73.538864,-64.323265,-65.364746,-72.692825,-80.576477,-72.678108,-74.937111,-82.983383,-73.038139,-74.431381,-79.627632,-72.866264,-85.138618,-73.880119,-76.429344,-73.273384,-81.028381,-74.571518,-74.892143,-82.698418,-65.184715,-70.610001,-70.902084,-71.877457,-74.940865,-81.881393,-76.197411,-81.273216,-75.629982,-79.561958,-77.129112,-74.124603,-78.503906,-80.559761,-78.766167,-76.097778,-77.699753,-74.600044,-76.469620,-70.837593,-74.332550,-70.924591,-72.767059,-76.518524,-77.344009,-83.806389,-80.530258,-73.230080,-80.191544,-79.550171,-79.958153,-73.400627,-77.990791,-76.792419,-83.019997,-76.743126,-90.472359,-67.504715,-70.044579,-57.504074,-59.104366,-71.595169,-65.989983,-68.758125,-69.864204,-70.538452,-94.763817,-82.766220,-79.434334,-79.117447,-75.795601,-82.691765,-76.390617,-81.036682,-76.617722,-80.368919,-81.609650,-67.975708,-64.096169,-59.816685,-71.888901,-74.225166,-71.955803,-74.521294,-74.999008,-75.464592,-80.899933,-78.648094,-76.844765,-81.634598,-76.319328,-79.304497,-77.708527,-77.763252,-84.660706,-76.212219,-77.540176,-79.456268,-65.821022,-77.165810,-91.540886,-71.431030,-77.196548,-80.096512,-80.503075,-83.032196,-77.053383,-80.301704,-78.339272,-80.031464,-82.876518,-75.493874,-80.083664,-80.655289,-81.781326,-79.796654,-77.556984,-71.009346,-72.873894,-82.727844,-73.524940,-85.475960,-87.133545,-78.716591,-77.957123,-79.416885,-79.001610,-78.329422,-79.654350,-81.029327,-80.197739,-80.395355,-76.948425,-84.457985,-77.380653,-72.623688,-72.454819,-66.443756,-84.823029,-94.234123,-73.499939,-76.790520,-75.225716,-88.196312,-84.051315,-80.456108,-80.444237,-78.733734,-82.843163,-80.011963,-81.903435,-79.680397,-78.191803,-81.344818,-80.768456,-78.106926,-83.880898,-79.715370,-79.905228,-78.580193,-82.962494,-83.012360,-79.481026,-79.908928,-82.727921,-78.465614,-85.129608,-77.747299,-79.418510,-83.469810,-81.713737,-78.161774,-83.775139,-80.010681,-82.343079,-76.672012,-78.412598,-83.770325,-78.067970,-83.205536,-83.033798,-81.066788,-78.703087,-81.800598,-80.360344,-82.563766,-80.794693,-84.476494,-77.443817,-84.026810,-80.768753,-82.535576,-82.700058,-77.852333,-78.105553,-73.448273,-81.833481,-81.228706,-81.215378,-78.004921,-80.530739,-81.514725,-82.993439,-80.574104,-82.193329,-85.420776,-79.829712,-80.887253,-80.334000,-81.183975,-83.610825,-79.259964,-77.717232,-77.425499,-67.930443,-73.609184,-86.603821,-74.247101,-80.102966,-94.174309,-81.628273,-79.328148,-77.656639,-81.331238,-79.369797,-86.114662,-79.258667,-81.945465,-82.376663,-76.618591,-78.813416,-75.047569,-73.091690,-73.364182,-68.262207,-79.912285,-82.107964,-75.802612,-78.865250,-82.272247,-88.138893,-84.129128,-82.535385,-81.504333,-79.269783,-87.355026,-85.742035,-78.763489,-84.604309,-81.034866,-81.039116,-87.225014,-77.866867,-76.767441,-94.703278,-79.306633,-80.039772,-79.278320,-80.774811,-84.486191,-85.562691,-81.625885,-82.481255,-79.782501,-85.252411,-79.909126,-82.151756,-84.440674,-81.275925,-79.924149,-81.192719,-74.694626,-76.396355,-71.188728,-80.662476,-83.792625,-77.181610,-80.669586,-79.567169,-85.978111,-86.791977,-80.580605,-84.348442,-81.767975,-83.220528,-79.333595,-82.274223,-77.998695,-80.097618,-82.490135,-75.511086,-71.638298,-65.628304,-78.003815,-74.864403,-72.410942,-76.299011,-82.688560,-83.588135,-81.675606,-78.509460,-81.806137,-79.770454,-80.522003,-87.270302,-80.920052,-86.731133,-80.129234,-77.369171,-114.984665,-78.951118,-73.699631,-83.315697,-84.131760,-75.228340,-80.001488,-82.696442,-74.990753,-69.660156,-79.777084,-78.654144,-75.390167,-84.626801,-84.270088,-82.222702,-89.004181,-82.083038,-81.231529,-79.680328,-90.932770,-73.437080,-92.299377,-83.311745,-77.275620,-89.896858,-83.500404,-79.318993,-80.424561,-86.428322,-84.854515,-84.328911,-78.402382,-86.940178,-81.504990,-89.066734,-79.990723,-91.553398,-75.218254,-80.251595,-77.792938,-78.134682,-77.382851,-90.578735,-84.784393,-76.067581,-81.156128,-76.913857,-74.249092,-80.064079,-77.854424,-84.727272,-83.629280,-86.578087,-83.635834,-86.559547,-76.715652,-84.241089,-73.690468,-83.907906,-79.247711,-77.866425,-75.309135,-86.265266,-89.387589,-76.585342,-89.979553,-85.960716,-84.081657,-82.229401,-85.542175,-81.343124,-84.440742,-85.814362,-82.403084,-82.863373,-82.106888,-82.918663,-83.156776,-82.429810,-88.444946,-81.175995,-84.221703,-85.316254,-83.522301,-83.914139,-87.181717,-82.365829,-84.753143,-82.925644,-83.206589,-84.943871,-84.142426,-86.079910,-82.553391,-83.460228,-82.723396,-84.794090,-83.199539,-86.964882,-81.536552,-85.371399,-82.597656,-83.394318,-84.288177,-85.021957,-82.330231,-87.212891,-83.336639,-88.550392,-82.078667,-87.299072,-82.894798,-87.438766,-80.676041,-85.181168,-83.349106,-80.274292,-85.098564,-82.536102,-84.308907,-85.767036,-82.443771,-85.581467,-82.236214,-91.770142,-81.068253,-88.947632,-82.256233,-83.986725,-83.992424,-84.740433,-84.793053,-82.188522,-85.243408,-81.568085,-85.435219,-90.452522,-79.336922,-81.424942,-89.196548,-81.585075,-85.849236,-83.469231,-86.900177,-82.248489,-83.435242,-83.420303,-95.331497,-79.551353,-89.191483,-83.672668,-86.435074,-82.254539,-89.707893,-84.622742,-80.609802,-88.577942,-82.929428,-82.442772,-89.201706,-82.523293,-83.167152,-88.632126,-84.098610,-84.633537,-85.201225,-83.505859,-83.736763,-85.439697,-83.179253,-85.292526,-82.486145,-83.527962,-84.497444,-75.392006,-77.067329,-75.571480,-74.934967,-79.779068,-80.235191,-78.201591,-88.130989,-84.949402,-85.054939,-81.333572,-88.828827,-82.828323,-82.935677,-85.870735,-88.051025,-84.979576,-91.695160,-78.182114,-80.688675,-69.981445,-73.852654,-74.936607,-72.778198,-78.447815,-81.237991,-91.696854,-75.569298,-78.774055,-88.082428,-92.837967,-77.456696,-80.542381,-81.422974,-82.325310,-86.337227,-85.033905,-83.065186,-76.939339,-90.551147,-87.993385,-81.903412,-81.144623,-95.269020,-84.433182,-82.188660,-86.792160,-82.244957,-88.464287,-83.491913,-90.788132,-81.823868,-83.476189,-82.971420,-94.806625,-81.247299,-88.052681,-77.846100,-98.903435,-76.616219,-94.982079,-80.553246,-91.866371,-81.318771,-85.762375,-87.007843,-87.341957,-81.774246,-83.177795,-81.336487,-83.148972,-87.566635,-79.239120,-102.696152,-80.759949,-83.833466,-81.505608,-80.384254,-82.985023,-94.060364,-87.978264,-77.832695,-86.749550,-95.556030,-81.059868,-84.522255,-79.352921,-91.635544,-86.152840,-79.587578,-84.211990,-81.178375,-97.149452,-84.561241,-80.766953,-83.379036,-73.547485,-81.228622,-73.777100,-78.535080,-75.882851,-91.364006,-78.350815,-82.839233,-81.544846,-92.847801,-82.026375,-78.369507,-77.204552,-83.021072,-101.148705,-76.412453,-77.849007,-81.456154,-81.465843,-74.490273,-76.625755,-78.473984,-80.774063,-75.091423,-70.831505,-73.236404,-75.244881,-79.558823,-83.636482,-74.359146,-75.601692,-76.952148,-74.029022,-84.326317,-73.796715,-85.599266,-81.285942,-85.084351,-82.278320,-73.978096,-74.246284,-68.514267,-73.423378,-73.494545,-76.658852,-86.352905,-86.675156,-84.215271,-79.067947,-81.045433,-90.688385,-80.173721,-84.056274,-76.115204,-83.871902,-84.957382,-79.529182,-81.928169,-86.344330,-83.798363,-75.907021,-86.821724,-90.150017,-79.115433,-83.122963,-127.873383,-78.681526,-87.899239,-79.049706,-86.223412,-85.461617,-87.861015,-82.115234,-82.944466,-89.761017,-81.683571,-81.618050,-81.663956,-79.173721,-95.036285,-76.927200,-89.972481,-80.106430,-80.422150,-83.519890,-82.349091,-107.285652,-79.319572,-89.454300,-86.598747,-79.999176,-86.408249,-78.707253,-85.876259,-81.563591,-87.726471,-81.410538,-88.569565,-90.589401,-78.474510,-84.254837,-100.887505,-82.584328,-81.003639,-104.188805,-84.703873,-80.311096,-99.145126,-79.198601,-90.489662,-86.832993,-81.278557,-78.788559,-92.076973,-83.217201,-80.663795,-83.910088,-77.360046,-77.606102,-76.469482,-87.283989,-77.749138,-82.250648,-94.025345,-78.493568,-81.957436,-90.143631,-80.263344,-82.516304,-76.777489,-88.797592,-83.737701,-100.006073,-76.421364,-84.632950,-74.228836,-70.308205,-78.418976,-79.868172,-82.236237,-83.572166,-77.493805,-78.245247,-83.916496,-84.497574,-79.364395,-87.191429,-81.202293,-85.152107,-82.659485,-79.995705,-80.178185,-87.926765,-86.349785,-75.377380,-78.158066,-75.291077,-77.386581,-78.198235,-77.504028,-76.811562,-79.608353,-83.688492,-82.120346,-83.522507,-92.959518,-81.215179,-87.958046,-83.593979,-87.568703,-87.964417,-81.988007,-83.380157,-88.447350,-80.070702,-88.982910,-88.282463,-84.023056,-82.152824,-92.275322,-81.531113,-83.867249,-81.730972,-85.449120,-86.810867,-85.379501,-84.372101,-84.466064,-89.109840,-86.914246,-80.830482,-93.737625,-82.466583,-83.565681,-88.647522,-86.018150,-89.075638,-82.121864,-84.793221,-84.341782,-82.937538,-88.320656,-82.696259,-85.404968,-85.766579,-83.719292,-86.654495,-85.734879,-85.211403,-83.205284,-88.513084,-84.149216,-88.383369]);
  var sampleRate = 16000;
  var expected = [300, 753, 2326];
  testGetFormants( u, sampleRate, expected );
});

module( "modules" );

test( "Create module, then add worm", function() {
  var COST = 3.09;
  VowelWorm.module('test', function(worm) {
    this.test = function() {
      return worm.arbysRoastBeefCost;
    };
  });
  var worm = new VowelWorm.instance();
  worm.arbysRoastBeefCost = COST;

  equal(worm.test.test(), COST);
  VowelWorm.removeModule('test');
  worm.destroy();
});

test( "Add worm, then create module", function() {
  var COST = 3.09;
  var worm = new VowelWorm.instance();
  worm.arbysRoastBeefCost = COST;

  VowelWorm.module('test', function(worm) {
    this.test = function() {
      return worm.arbysRoastBeefCost;
    };
  });

  equal(worm.test.test(), COST);
  VowelWorm.removeModule('test');
  worm.destroy();
});

module( "miscellaneous" );

test( "decibelsToLinear", function() {
  equal(VowelWorm.decibelsToLinear(-40), 0.01);
  equal(VowelWorm.decibelsToLinear(0), 1);
  close(VowelWorm.decibelsToLinear(-51), 0.002818, 0.000001);
});
