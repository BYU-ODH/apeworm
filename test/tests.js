module( "smoothing" );

test( "convolve method", function() {
  var y = [191,172,184,172,168,195,163,195,169,176,179,170,171, 156,174,168,188,148,143,172,170,152,141,141,171,188, 195,198,201,188,225,255,255,244,170,224,253,248,208, 168,222,240,225,170,179,220,227,201,163,201,228,224, 184,172,205,222,206,177,187,221,229,204,198,211,237, 236,207,199,223,238,223,201,202,229,238,215,187,202, 227,228,207,201,220,240,236,216,205,203,210,199,174, 166,167,169,158,155,158,165,160,149,148,144,138,136, 133,131,129,131,134,126,122,130,125,125,122,123,128, 124,116,109,119,125,117,108,113,118,116,118,118,114, 113,115,108,102,117,126,119,115,117,126,127,130,130, 134,137,139,152,149,141,152,164,171,169,168,172,180, 182,175,164,151,152,150,148,149,145,138,130,143,143, 142,135,135,139,141,151,150,145,148,147,154,153,148, 152,147,131,124,110,97,94,88,88,99,115,129,129, 126,125,127,130,126,119,121,121,121,122,122,107,108, 115,119,108,108,111,107,111,106,110,110,116,119,113, 104,115,125,128,133,129,120,107,110,113,117,110,113, 121,126,121,110,99,97,107,117,121,118,124,125,123, 121,118,115,114,116,111,116,121,127,125,125,126,128, 131,129,123,118,115,105,114,106,98,96,95,96,85, 78,69,63,40,37,42,42,45,42,35,26,28,36, 45,46,47,48,44,45,51,53,62,65,59,48,41, 55,47,40,46,60,65,64,70,82,84,82,78,86, 81,82,93,103,106,104,106,111,115,107,96,93,87, 86,92,92,91,95,88,72,57,52,64,61,53,54, 55,54,56,56,55,65,65,64,64,74,74,73,69, 63,74,80,78,78,68,84,95,91,82,84,86,86, 81,86,87,76,82,91,95,82,91,100,89,91,95, 86,87,84,75,62,64,61,57,51,45,40,37,35, 24,30,31,30,21,27,24,29,25,23,32,34,22, 30,37,41,37,27,30,27,23,26,22,15,8,3, 0,5,12,10,13,19,15,13,23,24,21,30,42, 49,49,45,54,66,66,60,59,65,70,69,59,72, 69,79,79,72,77,78,84,82,77,81,93,96,97, 93,93,102,103,100,102,102,98,99,100,96,95,99, 92,96,101,91,96,105,108,100,103,111,115,113,105, 96,106,100,96,88,100,104,98,98,90,84,86,88, 77,74,80,89,82,74,74,76,76,69,75,81,81, 81,88,91,93,87,92,93,83,83,81,86,85,81, 87,85,89,85,77,64,74,81,73,65,72,79,70, 59,60,63,69,68,60,58,64,64,54,60,49,40, 54,48,46,52,55,50,50,43,40,43,48,50,47, 56,63,56,62,73,62,57,76,75,78,73,75,79, 77,80,74,69,74,86,89,88,83,82,86,85,76, 66,73,76,76,71,71,70,64,51,48,59,61,53, 50,65,73,73,73,71,68,71,89,96,94,83,83, 86,87,90,91,91,86,83,88,85,79,90,85,86, 89,94,82,79,90,102,105,99,96,102,102,99,110, 112,103,94,97,107,105,99,99,89,82,79,84,88, 95,102,100,97,101,101,101,91,72,72,76,74,64, 59,59,58,54,57,52,55,65,65,60,57,64,67, 65,60,63,68,65,61,63,59,63,59,65,82,83, 85,85,88,92,94,108,113,104,107,105,101,93,95, 97,89,92,93,92,108,102,106,100,95,99,96,98, 96,92,93,93,86,87,87,89,84,82,85,84,84, 81,73,86,96,99,98,94,96,106,112,116,107,112, 104,102,101,90,89,89,92,87,78,74,69,71,59, 60,64,56,69,81,86,82,87,84,90,95,89,88, 94,102,106,102,93,92,105,109,109,99,102,105,101, 108,110,110,113,108,116,116,113,104,100,105,106,105, 100,94,103,98,90,93,107,108,96,84,92,93,95, 97,98,95,93,88,83,91,90,82,84,94,97,89, 99,104,99,94,95,103,92,92,99,99,104,99,101, 101,100,107,104,97,103,105,106,107,103,97,89,92, 97,96,90,90,97,91,91,98,94,87,82,72,77, 80,76,81,75,73,75,70,68,66,68,64,59,51, 51,60,60,60,60,57,59,64,68,64,58,57,42, 62,63,59,57,57,60,58,59,63,57,63,67,66, 58,54,48,50,58,59,55,64,74,71,71,74,85, 88,87,76,81,88,101,104,104,95,91,95,107,107, 103,93,92,104,108,103,91,91,97,92,78,85,91, 89,84,79,76,77,79,79,76,76,70,65,66,66, 69,64,64,58,54,60,58,61,64,60,54,54,58, 58,60,67,70,67,63,73,80,77,72,79,82,78, 77,79,85,96,86,77,73,70,83,79,84,65,85, 97,85,82,84,98,101,91,83,85,97,98,99,95, 92,89,90,93,91,95,92,92,83,83,91,84,83, 78,77,80,75,78,80,82,79,75,69,73,74,65, 64,63,63,59,52,56,52,57,52,52,45,47,44, 39,39,34,34,27,31,30,23,19,14,15,16,19, 23,30,31,27,34,34,39,39,44,47,45,52,52, 57,52,56,52,59,63,63,64,65,74,73,69];
  var m = [0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182,0.01818182];

  var desired = [191.09090909,191.65454545,192.27272727,192.14545455,192.41818182,193.38181818,194.,194.74545455,194.8,195.56363636,196.67272727,197.70909091,198.38181818,198.89090909,200.10909091,201.27272727,202.27272727,202.50909091,203.49090909,205.05454545,206.25454545,207.07272727,207.70909091,208.81818182,210.38181818,211.41818182,211.76363636,211.87272727,212.27272727,212.98181818,213.85454545,213.69090909,212.78181818,211.83636364,211.21818182,211.74545455,210.83636364,209.25454545,207.78181818,207.07272727,206.89090909,205.67272727,204.18181818,203.09090909,202.90909091,202.36363636,201.05454545,199.54545455,198.4,197.90909091,196.67272727,194.90909091,193.18181818,192.21818182,191.52727273,190.09090909,188.27272727,186.89090909,185.94545455,184.81818182,183.01818182,181.09090909,179.70909091,178.36363636,176.63636364,174.30909091,172.18181818,170.69090909,169.2,167.10909091,164.83636364,162.92727273,161.38181818,159.85454545,157.83636364,155.58181818,153.72727273,152.41818182,150.70909091,148.43636364,146.41818182,144.94545455,143.45454545,141.54545455,139.30909091,137.30909091,135.69090909,134.32727273,133.,131.61818182,130.49090909,129.85454545,129.6,129.27272727,128.76363636,128.65454545,128.81818182,129.05454545,129.12727273,129.27272727,129.69090909,130.27272727,130.96363636,131.63636364,132.14545455,132.47272727,132.85454545,133.23636364,133.54545455,133.81818182,134.16363636,134.45454545,134.45454545,134.78181818,135.10909091,135.47272727,135.69090909,135.81818182,136.09090909,136.54545455,137.30909091,137.87272727,138.23636364,138.8,139.50909091,140.25454545,140.89090909,141.47272727,142.09090909,142.61818182,142.92727273,143.12727273,143.03636364,142.83636364,142.69090909,142.16363636,141.47272727,141.10909091,141.10909091,141.32727273,141.38181818,141.36363636,141.27272727,141.21818182,141.14545455,140.94545455,140.58181818,140.01818182,139.50909091,139.14545455,138.6,137.83636364,136.67272727,135.56363636,134.6,133.63636364,132.32727273,130.98181818,129.81818182,128.78181818,128.05454545,127.21818182,126.49090909,125.8,125.2,124.72727273,124.27272727,123.8,123.29090909,122.96363636,122.70909091,122.67272727,122.56363636,122.21818182,121.6,120.85454545,120.18181818,119.67272727,118.98181818,118.36363636,117.76363636,117.27272727,116.78181818,116.01818182,115.14545455,114.52727273,114.21818182,114.34545455,114.78181818,115.21818182,115.87272727,116.54545455,116.98181818,117.09090909,116.89090909,116.63636364,116.41818182,116.25454545,115.96363636,115.70909091,115.61818182,115.76363636,115.83636364,115.90909091,116.,116.10909091,116.27272727,116.67272727,116.94545455,117.,116.92727273,116.87272727,116.98181818,116.89090909,116.72727273,116.45454545,116.25454545,116.,115.54545455,114.85454545,113.94545455,113.03636364,111.87272727,110.45454545,108.94545455,107.38181818,105.78181818,104.2,102.65454545,101.18181818,99.69090909,98.29090909,96.98181818,95.81818182,94.61818182,93.29090909,91.8,90.41818182,89.34545455,88.50909091,87.87272727,87.10909091,86.05454545,84.72727273,83.32727273,82.07272727,80.65454545,79.14545455,77.78181818,76.72727273,75.81818182,74.90909091,74.07272727,73.54545455,72.96363636,72.25454545,71.36363636,70.65454545,69.85454545,69.05454545,68.41818182,67.90909091,67.49090909,67.14545455,66.92727273,66.85454545,67.03636364,66.90909091,66.72727273,66.63636364,66.47272727,66.30909091,66.23636364,66.36363636,66.6,67.07272727,67.52727273,68.10909091,68.47272727,68.65454545,69.05454545,69.34545455,69.54545455,69.89090909,70.41818182,70.89090909,71.25454545,71.45454545,71.61818182,71.94545455,72.25454545,72.61818182,72.96363636,73.38181818,73.76363636,73.96363636,74.03636364,74.10909091,74.58181818,75.29090909,75.70909091,76.27272727,76.78181818,77.47272727,78.10909091,78.58181818,78.90909091,79.16363636,79.23636364,79.27272727,79.25454545,79.4,79.41818182,79.32727273,79.32727273,79.29090909,79.14545455,78.70909091,78.47272727,78.36363636,77.96363636,77.52727273,77.30909091,77.12727273,77.01818182,76.96363636,76.76363636,76.21818182,75.70909091,75.16363636,74.47272727,73.8,73.30909091,73.,72.72727273,72.2,71.52727273,71.10909091,70.69090909,70.23636364,69.63636364,69.10909091,68.52727273,68.05454545,67.32727273,66.56363636,65.98181818,65.43636364,64.49090909,63.69090909,63.03636364,62.52727273,62.05454545,61.2,60.29090909,59.36363636,58.36363636,57.6,56.47272727,55.01818182,53.50909091,52.07272727,50.54545455,49.07272727,47.72727273,46.43636364,45.10909091,43.87272727,42.76363636,41.50909091,40.27272727,38.98181818,37.87272727,36.76363636,35.70909091,34.98181818,34.21818182,33.30909091,32.72727273,32.34545455,32.01818182,31.74545455,31.69090909,31.70909091,31.87272727,32.09090909,32.23636364,32.72727273,33.25454545,34.01818182,34.81818182,35.69090909,36.54545455,37.4,38.38181818,39.49090909,40.4,41.43636364,42.6,43.89090909,45.23636364,46.34545455,47.41818182,48.87272727,50.2,51.34545455,52.45454545,53.63636364,54.92727273,56.18181818,57.50909091,58.83636364,60.09090909,61.49090909,62.89090909,64.49090909,66.27272727,67.92727273,69.58181818,71.27272727,73.05454545,74.63636364,76.16363636,77.90909091,79.76363636,81.4,82.87272727,84.23636364,85.61818182,86.67272727,87.52727273,88.23636364,89.23636364,90.14545455,90.72727273,91.30909091,91.85454545,92.30909091,92.69090909,93.01818182,93.16363636,93.43636364,93.58181818,93.94545455,94.,93.90909091,93.94545455,93.92727273,93.89090909,93.61818182,93.49090909,93.56363636,93.56363636,93.34545455,93.2,93.09090909,93.09090909,92.98181818,92.8,92.61818182,92.30909091,91.96363636,91.58181818,91.36363636,91.10909091,90.76363636,90.6,90.41818182,90.23636364,90.10909091,89.76363636,89.09090909,88.78181818,88.50909091,87.92727273,87.14545455,86.63636364,86.2,85.45454545,84.43636364,83.47272727,82.70909091,82.21818182,81.52727273,80.8,80.10909091,79.67272727,79.01818182,78.10909091,77.41818182,76.52727273,75.61818182,75.07272727,74.38181818,73.61818182,73.16363636,72.81818182,72.27272727,71.56363636,70.85454545,70.23636364,69.67272727,69.16363636,68.69090909,68.29090909,67.94545455,67.61818182,67.16363636,66.81818182,66.54545455,66.01818182,65.36363636,65.16363636,64.85454545,64.58181818,64.4,64.25454545,64.21818182,64.05454545,63.96363636,63.83636364,63.50909091,63.30909091,63.25454545,63.32727273,63.52727273,63.87272727,64.01818182,64.10909091,64.32727273,64.52727273,64.41818182,64.30909091,64.41818182,64.72727273,64.92727273,65.07272727,65.09090909,65.01818182,64.85454545,64.67272727,64.58181818,64.52727273,64.50909091,64.32727273,64.61818182,65.21818182,65.56363636,66.01818182,66.47272727,66.76363636,67.05454545,67.76363636,68.6,69.52727273,70.30909091,71.03636364,71.72727273,72.4,73.18181818,73.81818182,74.32727273,74.87272727,75.25454545,75.52727273,75.94545455,76.34545455,76.6,76.78181818,76.92727273,77.21818182,77.56363636,77.61818182,77.65454545,77.83636364,78.34545455,79.,79.45454545,79.63636364,79.87272727,80.12727273,80.41818182,80.92727273,81.4,81.72727273,82.05454545,82.61818182,83.23636364,83.76363636,84.18181818,84.69090909,85.01818182,85.23636364,85.50909091,86.10909091,86.83636364,87.49090909,88.23636364,89.09090909,89.94545455,90.6,91.10909091,91.61818182,91.94545455,91.96363636,92.03636364,92.12727273,91.85454545,91.27272727,90.63636364,90.2,89.74545455,89.16363636,88.61818182,87.92727273,87.27272727,86.8,86.41818182,86.,85.43636364,85.05454545,84.83636364,84.38181818,83.92727273,83.50909091,83.12727273,82.6,82.21818182,81.92727273,81.36363636,80.65454545,79.81818182,79.2,78.94545455,78.6,78.29090909,78.03636364,77.63636364,77.27272727,77.10909091,77.36363636,77.65454545,77.6,77.63636364,77.74545455,77.78181818,77.85454545,78.09090909,78.41818182,78.50909091,78.58181818,78.54545455,78.36363636,78.50909091,78.6,78.69090909,78.67272727,78.56363636,78.70909091,79.14545455,79.61818182,79.98181818,80.30909091,80.83636364,81.45454545,81.94545455,82.47272727,83.07272727,83.65454545,84.23636364,84.72727273,85.09090909,85.43636364,85.87272727,86.30909091,86.47272727,86.81818182,87.38181818,88.09090909,88.72727273,89.2,89.76363636,90.58181818,91.47272727,92.50909091,93.30909091,94.27272727,94.98181818,95.34545455,95.67272727,95.76363636,95.83636364,95.85454545,95.85454545,95.72727273,95.18181818,94.47272727,93.83636364,93.18181818,92.34545455,91.6,91.07272727,90.36363636,89.85454545,89.70909091,89.6,89.4,89.30909091,88.87272727,88.65454545,88.45454545,88.25454545,88.12727273,88.03636364,88.14545455,88.29090909,88.4,88.41818182,88.4,88.61818182,89.03636364,89.43636364,89.65454545,89.89090909,90.27272727,90.61818182,91.03636364,91.50909091,91.98181818,92.56363636,93.2,93.74545455,94.10909091,94.36363636,94.47272727,94.58181818,94.74545455,94.74545455,94.61818182,94.32727273,94.09090909,93.92727273,93.81818182,93.6,93.45454545,93.76363636,94.10909091,94.23636364,94.09090909,94.18181818,94.45454545,94.83636364,95.34545455,95.83636364,96.49090909,97.09090909,97.52727273,98.01818182,98.41818182,98.58181818,98.50909091,98.54545455,98.67272727,98.90909091,98.89090909,98.96363636,99.23636364,99.43636364,99.43636364,99.30909091,99.25454545,99.07272727,99.05454545,99.18181818,99.07272727,98.98181818,98.8,98.83636364,98.81818182,98.72727273,98.83636364,98.76363636,98.52727273,98.4,98.25454545,98.21818182,98.05454545,97.81818182,97.52727273,97.25454545,97.10909091,96.96363636,96.78181818,96.50909091,96.32727273,96.38181818,96.16363636,96.03636364,96.18181818,96.2,95.83636364,95.36363636,94.92727273,94.8,94.58181818,94.27272727,94.01818182,93.61818182,93.16363636,92.8,92.38181818,92.01818182,91.70909091,91.29090909,90.81818182,90.4,89.8,89.01818182,88.34545455,87.81818182,87.10909091,86.30909091,85.54545455,84.90909091,84.34545455,83.70909091,83.2,82.58181818,81.81818182,80.78181818,80.01818182,79.36363636,78.6,77.8,77.01818182,76.16363636,75.32727273,74.63636364,73.90909091,73.03636364,72.25454545,71.52727273,70.85454545,70.14545455,69.50909091,68.70909091,67.85454545,67.16363636,66.6,65.96363636,65.36363636,65.05454545,64.69090909,64.2,63.83636364,63.8,63.90909091,64.18181818,64.16363636,64.18181818,64.4,64.76363636,65.29090909,65.85454545,66.21818182,66.6,67.09090909,67.83636364,68.54545455,69.25454545,69.87272727,70.61818182,71.58181818,72.45454545,73.23636364,73.8,74.36363636,75.09090909,75.69090909,75.94545455,76.25454545,76.74545455,77.30909091,77.8,78.47272727,78.72727273,78.98181818,79.34545455,79.74545455,80.09090909,80.38181818,80.6,80.70909091,80.76363636,80.92727273,81.03636364,80.98181818,80.94545455,80.94545455,80.94545455,81.16363636,81.30909091,81.36363636,81.45454545,81.54545455,81.36363636,81.,80.76363636,80.52727273,80.27272727,79.94545455,79.61818182,79.25454545,79.01818182,78.87272727,78.72727273,78.29090909,77.70909091,77.25454545,77.01818182,76.78181818,76.45454545,75.94545455,75.54545455,75.41818182,75.29090909,75.01818182,74.45454545,73.76363636,73.4,73.18181818,73.05454545,72.47272727,72.34545455,72.69090909,72.69090909,72.52727273,72.43636364,72.69090909,73.09090909,73.36363636,73.47272727,73.58181818,73.90909091,74.30909091,74.72727273,75.18181818,75.67272727,76.09090909,76.52727273,76.96363636,77.45454545,78.01818182,78.63636364,79.32727273,79.74545455,80.2,80.74545455,81.10909091,81.52727273,81.96363636,82.38181818,82.78181818,83.09090909,83.41818182,83.65454545,83.87272727,84.09090909,84.30909091,84.23636364,84.10909091,84.05454545,83.92727273,83.65454545,83.30909091,83.03636364,82.70909091,82.21818182,81.69090909,80.89090909,80.36363636,79.90909091,79.52727273,79.07272727,78.41818182,77.78181818,76.96363636,76.49090909,75.56363636,74.41818182,73.36363636,72.43636364,71.45454545,70.09090909,68.6,67.2,65.96363636,64.70909091,63.29090909,61.92727273,60.67272727,59.50909091,58.32727273,57.32727273,56.30909091,55.32727273,54.38181818,53.45454545,52.63636364,51.78181818,51.21818182,50.65454545,50.03636364,49.45454545,48.96363636,48.49090909,48.16363636,47.85454545,47.63636364,47.38181818,47.10909091,46.96363636,46.85454545,46.74545455];

  deepEqual(VowelWorm.convolve(m,y), VowelWorm.convolve(y,m), "Convolution ignores argument order.");
  deepEqual(VowelWorm.convolve(m,y).length, desired.length, "Convolution is the correct length.");
  deepEqual(VowelWorm.convolve(m,y).map(Math.round), desired.map(Math.round), "Convolution matches expected output.");
});

test( "smooth method", function() {
  var vowel = [198,201,188,225,255,255,244,170,224,253,248,208,168,222,240,225,170,179,220,227,201,163,201,228,224,184,172,205,222,206,177,187,221,229,204,198,211,237,236,207,199,223,238,223,201,202,229,238,215,187,202,227,228,207,201,220,240,236,216,205,203,210,199,174,166,167,169,158,155,158,165,160,149,148,144,138,136,133,131,129,131,134,126,122,130,125,125,122,123,128,124,116,109,119,125,117,108,113,118,116,118,118,114,113,115,108,102,117,126,119,115,117,126,127,130,130,134,137,139,152,149,141,152,164,171,169,168,172,180,182,175,164,151,152,150,148,149,145,138,130,143,143,142,135,135,139,141,151,150,145,148,147,154,153,148,152,147,131,124,110,97,94,88,88,99,115,129,129,126,125,127,130,126,119,121,121,121,122,122,107,108,115,119,108,108,111,107,111,106,110,110,116,119,113,104,115,125,128,133,129,120,107,110,113,117,110,113,121,126,121,110,99,97,107,117,121,118,124,125,123,121,118,115,114,116,111,116,121,127,125,125,126,128,131,129,123,118,115,105,114,106,98,96,95,96,85,78,69,63,40,37,42,42,45,42,35,26,28,36,45,46,47,48,44,45,51,53,62,65,59,48,41,55,47,40,46,60,65,64,70,82,84,82,78,86,81,82,93,103,106,104,106,111,115,107,96,93,87,86,92,92,91,95,88,72,57,52,64,61,53,54,55,54,56,56,55,65,65,64,64,74,74,73,69,63,74,80,78,78,68,84,95,91,82,84,86,86,81,86,87,76,82,91,95,82,91,100,89,91,95,86,87,84,75,62,64,61,57,51,45,40,37,35,24,30,31,30,21,27,24,29,25,23,32,34,22,30,37,41,37,27,30,27,23,26,22,15,8,3,0,5,12,10,13,19,15,13,23,24,21,30,42,49,49,45,54,66,66,60,59,65,70,69,59,72,69,79,79,72,77,78,84,82,77,81,93,96,97,93,93,102,103,100,102,102,98,99,100,96,95,99,92,96,101,91,96,105,108,100,103,111,115,113,105,96,106,100,96,88,100,104,98,98,90,84,86,88,77,74,80,89,82,74,74,76,76,69,75,81,81,81,88,91,93,87,92,93,83,83,81,86,85,81,87,85,89,85,77,64,74,81,73,65,72,79,70,59,60,63,69,68,60,58,64,64,54,60,49,40,54,48,46,52,55,50,50,43,40,43,48,50,47,56,63,56,62,73,62,57,76,75,78,73,75,79,77,80,74,69,74,86,89,88,83,82,86,85,76,66,73,76,76,71,71,70,64,51,48,59,61,53,50,65,73,73,73,71,68,71,89,96,94,83,83,86,87,90,91,91,86,83,88,85,79,90,85,86,89,94,82,79,90,102,105,99,96,102,102,99,110,112,103,94,97,107,105,99,99,89,82,79,84,88,95,102,100,97,101,101,101,91,72,72,76,74,64,59,59,58,54,57,52,55,65,65,60,57,64,67,65,60,63,68,65,61,63,59,63,59,65,82,83,85,85,88,92,94,108,113,104,107,105,101,93,95,97,89,92,93,92,108,102,106,100,95,99,96,98,96,92,93,93,86,87,87,89,84,82,85,84,84,81,73,86,96,99,98,94,96,106,112,116,107,112,104,102,101,90,89,89,92,87,78,74,69,71,59,60,64,56,69,81,86,82,87,84,90,95,89,88,94,102,106,102,93,92,105,109,109,99,102,105,101,108,110,110,113,108,116,116,113,104,100,105,106,105,100,94,103,98,90,93,107,108,96,84,92,93,95,97,98,95,93,88,83,91,90,82,84,94,97,89,99,104,99,94,95,103,92,92,99,99,104,99,101,101,100,107,104,97,103,105,106,107,103,97,89,92,97,96,90,90,97,91,91,98,94,87,82,72,77,80,76,81,75,73,75,70,68,66,68,64,59,51,51,60,60,60,60,57,59,64,68,64,58,57,42,62,63,59,57,57,60,58,59,63,57,63,67,66,58,54,48,50,58,59,55,64,74,71,71,74,85,88,87,76,81,88,101,104,104,95,91,95,107,107,103,93,92,104,108,103,91,91,97,92,78,85,91,89,84,79,76,77,79,79,76,76,70,65,66,66,69,64,64,58,54,60,58,61,64,60,54,54,58,58,60,67,70,67,63,73,80,77,72,79,82,78,77,79,85,96,86,77,73,70,83,79,84,65,85,97,85,82,84,98,101,91,83,85,97,98,99,95,92,89,90,93,91,95,92,92,83,83,91,84,83,78,77,80,75,78,80,82,79,75,69,73,74,65,64,63,63,59,52,56,52,57,52,52,45,47,44,39,39,34,34,27,31,30,23,19,14,15];
  var WINDOW_SIZE = 55;
  var ORDER = 1;
  var DERIVATIVE = 0;
  var desired = [191.09090909,191.65454545,192.27272727,192.14545455,192.41818182,193.38181818,194.,194.74545455,194.8,195.56363636,196.67272727,197.70909091,198.38181818,198.89090909,200.10909091,201.27272727,202.27272727,202.50909091,203.49090909,205.05454545,206.25454545,207.07272727,207.70909091,208.81818182,210.38181818,211.41818182,211.76363636,211.87272727,212.27272727,212.98181818,213.85454545,213.69090909,212.78181818,211.83636364,211.21818182,211.74545455,210.83636364,209.25454545,207.78181818,207.07272727,206.89090909,205.67272727,204.18181818,203.09090909,202.90909091,202.36363636,201.05454545,199.54545455,198.4,197.90909091,196.67272727,194.90909091,193.18181818,192.21818182,191.52727273,190.09090909,188.27272727,186.89090909,185.94545455,184.81818182,183.01818182,181.09090909,179.70909091,178.36363636,176.63636364,174.30909091,172.18181818,170.69090909,169.2,167.10909091,164.83636364,162.92727273,161.38181818,159.85454545,157.83636364,155.58181818,153.72727273,152.41818182,150.70909091,148.43636364,146.41818182,144.94545455,143.45454545,141.54545455,139.30909091,137.30909091,135.69090909,134.32727273,133.,131.61818182,130.49090909,129.85454545,129.6,129.27272727,128.76363636,128.65454545,128.81818182,129.05454545,129.12727273,129.27272727,129.69090909,130.27272727,130.96363636,131.63636364,132.14545455,132.47272727,132.85454545,133.23636364,133.54545455,133.81818182,134.16363636,134.45454545,134.45454545,134.78181818,135.10909091,135.47272727,135.69090909,135.81818182,136.09090909,136.54545455,137.30909091,137.87272727,138.23636364,138.8,139.50909091,140.25454545,140.89090909,141.47272727,142.09090909,142.61818182,142.92727273,143.12727273,143.03636364,142.83636364,142.69090909,142.16363636,141.47272727,141.10909091,141.10909091,141.32727273,141.38181818,141.36363636,141.27272727,141.21818182,141.14545455,140.94545455,140.58181818,140.01818182,139.50909091,139.14545455,138.6,137.83636364,136.67272727,135.56363636,134.6,133.63636364,132.32727273,130.98181818,129.81818182,128.78181818,128.05454545,127.21818182,126.49090909,125.8,125.2,124.72727273,124.27272727,123.8,123.29090909,122.96363636,122.70909091,122.67272727,122.56363636,122.21818182,121.6,120.85454545,120.18181818,119.67272727,118.98181818,118.36363636,117.76363636,117.27272727,116.78181818,116.01818182,115.14545455,114.52727273,114.21818182,114.34545455,114.78181818,115.21818182,115.87272727,116.54545455,116.98181818,117.09090909,116.89090909,116.63636364,116.41818182,116.25454545,115.96363636,115.70909091,115.61818182,115.76363636,115.83636364,115.90909091,116.,116.10909091,116.27272727,116.67272727,116.94545455,117.,116.92727273,116.87272727,116.98181818,116.89090909,116.72727273,116.45454545,116.25454545,116.,115.54545455,114.85454545,113.94545455,113.03636364,111.87272727,110.45454545,108.94545455,107.38181818,105.78181818,104.2,102.65454545,101.18181818,99.69090909,98.29090909,96.98181818,95.81818182,94.61818182,93.29090909,91.8,90.41818182,89.34545455,88.50909091,87.87272727,87.10909091,86.05454545,84.72727273,83.32727273,82.07272727,80.65454545,79.14545455,77.78181818,76.72727273,75.81818182,74.90909091,74.07272727,73.54545455,72.96363636,72.25454545,71.36363636,70.65454545,69.85454545,69.05454545,68.41818182,67.90909091,67.49090909,67.14545455,66.92727273,66.85454545,67.03636364,66.90909091,66.72727273,66.63636364,66.47272727,66.30909091,66.23636364,66.36363636,66.6,67.07272727,67.52727273,68.10909091,68.47272727,68.65454545,69.05454545,69.34545455,69.54545455,69.89090909,70.41818182,70.89090909,71.25454545,71.45454545,71.61818182,71.94545455,72.25454545,72.61818182,72.96363636,73.38181818,73.76363636,73.96363636,74.03636364,74.10909091,74.58181818,75.29090909,75.70909091,76.27272727,76.78181818,77.47272727,78.10909091,78.58181818,78.90909091,79.16363636,79.23636364,79.27272727,79.25454545,79.4,79.41818182,79.32727273,79.32727273,79.29090909,79.14545455,78.70909091,78.47272727,78.36363636,77.96363636,77.52727273,77.30909091,77.12727273,77.01818182,76.96363636,76.76363636,76.21818182,75.70909091,75.16363636,74.47272727,73.8,73.30909091,73.,72.72727273,72.2,71.52727273,71.10909091,70.69090909,70.23636364,69.63636364,69.10909091,68.52727273,68.05454545,67.32727273,66.56363636,65.98181818,65.43636364,64.49090909,63.69090909,63.03636364,62.52727273,62.05454545,61.2,60.29090909,59.36363636,58.36363636,57.6,56.47272727,55.01818182,53.50909091,52.07272727,50.54545455,49.07272727,47.72727273,46.43636364,45.10909091,43.87272727,42.76363636,41.50909091,40.27272727,38.98181818,37.87272727,36.76363636,35.70909091,34.98181818,34.21818182,33.30909091,32.72727273,32.34545455,32.01818182,31.74545455,31.69090909,31.70909091,31.87272727,32.09090909,32.23636364,32.72727273,33.25454545,34.01818182,34.81818182,35.69090909,36.54545455,37.4,38.38181818,39.49090909,40.4,41.43636364,42.6,43.89090909,45.23636364,46.34545455,47.41818182,48.87272727,50.2,51.34545455,52.45454545,53.63636364,54.92727273,56.18181818,57.50909091,58.83636364,60.09090909,61.49090909,62.89090909,64.49090909,66.27272727,67.92727273,69.58181818,71.27272727,73.05454545,74.63636364,76.16363636,77.90909091,79.76363636,81.4,82.87272727,84.23636364,85.61818182,86.67272727,87.52727273,88.23636364,89.23636364,90.14545455,90.72727273,91.30909091,91.85454545,92.30909091,92.69090909,93.01818182,93.16363636,93.43636364,93.58181818,93.94545455,94.,93.90909091,93.94545455,93.92727273,93.89090909,93.61818182,93.49090909,93.56363636,93.56363636,93.34545455,93.2,93.09090909,93.09090909,92.98181818,92.8,92.61818182,92.30909091,91.96363636,91.58181818,91.36363636,91.10909091,90.76363636,90.6,90.41818182,90.23636364,90.10909091,89.76363636,89.09090909,88.78181818,88.50909091,87.92727273,87.14545455,86.63636364,86.2,85.45454545,84.43636364,83.47272727,82.70909091,82.21818182,81.52727273,80.8,80.10909091,79.67272727,79.01818182,78.10909091,77.41818182,76.52727273,75.61818182,75.07272727,74.38181818,73.61818182,73.16363636,72.81818182,72.27272727,71.56363636,70.85454545,70.23636364,69.67272727,69.16363636,68.69090909,68.29090909,67.94545455,67.61818182,67.16363636,66.81818182,66.54545455,66.01818182,65.36363636,65.16363636,64.85454545,64.58181818,64.4,64.25454545,64.21818182,64.05454545,63.96363636,63.83636364,63.50909091,63.30909091,63.25454545,63.32727273,63.52727273,63.87272727,64.01818182,64.10909091,64.32727273,64.52727273,64.41818182,64.30909091,64.41818182,64.72727273,64.92727273,65.07272727,65.09090909,65.01818182,64.85454545,64.67272727,64.58181818,64.52727273,64.50909091,64.32727273,64.61818182,65.21818182,65.56363636,66.01818182,66.47272727,66.76363636,67.05454545,67.76363636,68.6,69.52727273,70.30909091,71.03636364,71.72727273,72.4,73.18181818,73.81818182,74.32727273,74.87272727,75.25454545,75.52727273,75.94545455,76.34545455,76.6,76.78181818,76.92727273,77.21818182,77.56363636,77.61818182,77.65454545,77.83636364,78.34545455,79.,79.45454545,79.63636364,79.87272727,80.12727273,80.41818182,80.92727273,81.4,81.72727273,82.05454545,82.61818182,83.23636364,83.76363636,84.18181818,84.69090909,85.01818182,85.23636364,85.50909091,86.10909091,86.83636364,87.49090909,88.23636364,89.09090909,89.94545455,90.6,91.10909091,91.61818182,91.94545455,91.96363636,92.03636364,92.12727273,91.85454545,91.27272727,90.63636364,90.2,89.74545455,89.16363636,88.61818182,87.92727273,87.27272727,86.8,86.41818182,86.,85.43636364,85.05454545,84.83636364,84.38181818,83.92727273,83.50909091,83.12727273,82.6,82.21818182,81.92727273,81.36363636,80.65454545,79.81818182,79.2,78.94545455,78.6,78.29090909,78.03636364,77.63636364,77.27272727,77.10909091,77.36363636,77.65454545,77.6,77.63636364,77.74545455,77.78181818,77.85454545,78.09090909,78.41818182,78.50909091,78.58181818,78.54545455,78.36363636,78.50909091,78.6,78.69090909,78.67272727,78.56363636,78.70909091,79.14545455,79.61818182,79.98181818,80.30909091,80.83636364,81.45454545,81.94545455,82.47272727,83.07272727,83.65454545,84.23636364,84.72727273,85.09090909,85.43636364,85.87272727,86.30909091,86.47272727,86.81818182,87.38181818,88.09090909,88.72727273,89.2,89.76363636,90.58181818,91.47272727,92.50909091,93.30909091,94.27272727,94.98181818,95.34545455,95.67272727,95.76363636,95.83636364,95.85454545,95.85454545,95.72727273,95.18181818,94.47272727,93.83636364,93.18181818,92.34545455,91.6,91.07272727,90.36363636,89.85454545,89.70909091,89.6,89.4,89.30909091,88.87272727,88.65454545,88.45454545,88.25454545,88.12727273,88.03636364,88.14545455,88.29090909,88.4,88.41818182,88.4,88.61818182,89.03636364,89.43636364,89.65454545,89.89090909,90.27272727,90.61818182,91.03636364,91.50909091,91.98181818,92.56363636,93.2,93.74545455,94.10909091,94.36363636,94.47272727,94.58181818,94.74545455,94.74545455,94.61818182,94.32727273,94.09090909,93.92727273,93.81818182,93.6,93.45454545,93.76363636,94.10909091,94.23636364,94.09090909,94.18181818,94.45454545,94.83636364,95.34545455,95.83636364,96.49090909,97.09090909,97.52727273,98.01818182,98.41818182,98.58181818,98.50909091,98.54545455,98.67272727,98.90909091,98.89090909,98.96363636,99.23636364,99.43636364,99.43636364,99.30909091,99.25454545,99.07272727,99.05454545,99.18181818,99.07272727,98.98181818,98.8,98.83636364,98.81818182,98.72727273,98.83636364,98.76363636,98.52727273,98.4,98.25454545,98.21818182,98.05454545,97.81818182,97.52727273,97.25454545,97.10909091,96.96363636,96.78181818,96.50909091,96.32727273,96.38181818,96.16363636,96.03636364,96.18181818,96.2,95.83636364,95.36363636,94.92727273,94.8,94.58181818,94.27272727,94.01818182,93.61818182,93.16363636,92.8,92.38181818,92.01818182,91.70909091,91.29090909,90.81818182,90.4,89.8,89.01818182,88.34545455,87.81818182,87.10909091,86.30909091,85.54545455,84.90909091,84.34545455,83.70909091,83.2,82.58181818,81.81818182,80.78181818,80.01818182,79.36363636,78.6,77.8,77.01818182,76.16363636,75.32727273,74.63636364,73.90909091,73.03636364,72.25454545,71.52727273,70.85454545,70.14545455,69.50909091,68.70909091,67.85454545,67.16363636,66.6,65.96363636,65.36363636,65.05454545,64.69090909,64.2,63.83636364,63.8,63.90909091,64.18181818,64.16363636,64.18181818,64.4,64.76363636,65.29090909,65.85454545,66.21818182,66.6,67.09090909,67.83636364,68.54545455,69.25454545,69.87272727,70.61818182,71.58181818,72.45454545,73.23636364,73.8,74.36363636,75.09090909,75.69090909,75.94545455,76.25454545,76.74545455,77.30909091,77.8,78.47272727,78.72727273,78.98181818,79.34545455,79.74545455,80.09090909,80.38181818,80.6,80.70909091,80.76363636,80.92727273,81.03636364,80.98181818,80.94545455,80.94545455,80.94545455,81.16363636,81.30909091,81.36363636,81.45454545,81.54545455,81.36363636,81.,80.76363636,80.52727273,80.27272727,79.94545455,79.61818182,79.25454545,79.01818182,78.87272727,78.72727273,78.29090909,77.70909091,77.25454545,77.01818182,76.78181818,76.45454545,75.94545455,75.54545455,75.41818182,75.29090909,75.01818182,74.45454545,73.76363636,73.4,73.18181818,73.05454545,72.47272727,72.34545455,72.69090909,72.69090909,72.52727273,72.43636364,72.69090909,73.09090909,73.36363636,73.47272727,73.58181818,73.90909091,74.30909091,74.72727273,75.18181818,75.67272727,76.09090909,76.52727273,76.96363636,77.45454545,78.01818182,78.63636364,79.32727273,79.74545455,80.2,80.74545455,81.10909091,81.52727273,81.96363636,82.38181818,82.78181818,83.09090909,83.41818182,83.65454545,83.87272727,84.09090909,84.30909091,84.23636364,84.10909091,84.05454545,83.92727273,83.65454545,83.30909091,83.03636364,82.70909091,82.21818182,81.69090909,80.89090909,80.36363636,79.90909091,79.52727273,79.07272727,78.41818182,77.78181818,76.96363636,76.49090909,75.56363636,74.41818182,73.36363636,72.43636364,71.45454545,70.09090909,68.6,67.2,65.96363636,64.70909091,63.29090909,61.92727273,60.67272727,59.50909091,58.32727273,57.32727273,56.30909091,55.32727273,54.38181818,53.45454545,52.63636364,51.78181818,51.21818182,50.65454545,50.03636364,49.45454545,48.96363636,48.49090909,48.16363636,47.85454545,47.63636364,47.38181818,47.10909091,46.96363636,46.85454545,46.74545455];
  var result = VowelWorm.smoothCurve(vowel, WINDOW_SIZE, ORDER);
  var uint8result = VowelWorm.smoothCurve(new Uint8Array(vowel), WINDOW_SIZE, ORDER);

  deepEqual(result.map(Math.round), desired.map(Math.round), "Smoothing matches expected.");
  deepEqual(uint8result.map(Math.round), desired.map(Math.round), "Smoothing works with unsigned array.");
});

/*************************/

module( "peak finding" );

test( "simple array", function() {
  var data = [0,10,0,0,10,0],
      expected = [1,4];
  deepEqual(VowelWorm.getPeaks(data), expected);
});

test( "typed array", function() {
  var data = new Uint8Array([0,10,0,0,10,0]),
      expected = [1,4];
  deepEqual(VowelWorm.getPeaks(data), expected);
});

test( "starts high", function() {
  var data = [255,0,0,0,0],
      expected = [0];
  deepEqual(VowelWorm.getPeaks(data), expected);
});

test( "ends high", function() {
  var data = [0,0,255],
      expected = [2];
  deepEqual(VowelWorm.getPeaks(data), expected);
});

test( "no peaks", function() {
  var data = [0,0,0,0,0],
      expected = [];
  deepEqual(VowelWorm.getPeaks(data), expected);
});


module( "vs. Wavesurfer's LPC" );

function testGetFormants(data, sampleRate, expected) {
  var LEEWAY = 300; // amount to forgive, in Hz
  var worm = new VowelWorm.instance();
  var formants = worm.getFormants(data, sampleRate);
  close(formants[0], expected[0], LEEWAY, "F1 matches");
  close(formants[1], expected[1], LEEWAY, "F2 matches");
  close(formants[2], expected[2], LEEWAY, "F3 matches");
}

test( "ae", function() {
  var ae = new Float32Array([-22.727865,-30.058773,-67.662537,-63.230507,-67.310753,-71.779541,-68.448433,-78.303696,-79.491425,-71.479942,-65.038139,-74.566231,-77.874985,-65.987312,-52.824326,-45.969223,-20.430431,-13.396776,-20.753382,-47.290604,-49.735783,-70.647034,-62.081093,-66.290352,-62.086151,-59.665398,-62.687820,-57.307308,-81.834709,-54.252602,-57.606815,-45.986160,-40.408382,-18.851553,-12.251842,-19.870752,-42.000679,-45.383148,-57.405323,-55.963577,-60.921627,-58.019897,-64.523109,-76.344688,-58.201252,-58.769096,-54.627151,-57.758354,-51.887676,-48.358215,-24.801945,-19.375973,-28.285305,-48.922615,-50.965710,-63.758286,-55.098850,-72.276085,-57.518044,-62.350605,-60.798409,-59.691769,-63.360214,-51.548199,-54.117977,-42.488102,-38.531227,-20.431351,-14.606422,-22.012882,-39.454826,-41.213570,-57.218681,-47.644547,-57.313789,-47.037785,-52.444374,-57.722149,-47.647175,-48.319038,-43.040970,-41.333794,-38.856403,-35.793636,-15.436175,-11.408807,-22.468348,-34.632660,-36.547737,-47.984833,-44.855385,-46.040245,-46.561443,-43.838490,-56.313129,-48.703003,-51.053844,-44.448074,-38.742653,-30.421825,-25.842478,-13.021287,-7.564312,-15.849034,-30.923834,-34.823364,-44.067795,-43.370743,-58.492073,-47.379459,-65.135002,-51.431480,-45.906487,-58.919159,-45.508343,-47.707726,-47.673630,-46.046120,-27.891022,-27.233326,-39.809292,-43.895580,-49.746906,-54.576645,-53.111961,-51.439899,-67.635475,-47.976345,-55.703651,-57.006184,-66.859489,-53.463585,-51.529358,-44.801468,-38.618092,-27.224184,-23.275013,-30.473026,-46.171101,-46.093025,-53.172661,-59.474407,-58.390194,-65.240646,-58.906696,-61.972355,-56.540688,-52.714573,-55.535458,-52.750252,-48.892651,-48.912560,-32.249306,-31.294123,-48.708069,-55.173313,-58.315224,-64.298363,-55.481483,-62.600693,-61.871876,-54.813465,-62.508667,-66.910728,-68.250885,-59.765259,-53.312824,-43.721283,-39.601242,-28.460854,-25.828600,-34.129391,-43.571148,-46.071423,-52.450493,-52.187580,-56.815186,-57.118774,-63.124306,-59.158657,-53.606926,-52.155312,-50.517834,-46.049694,-44.561916,-46.597366,-29.356569,-28.569572,-49.466484,-45.900593,-51.296597,-54.413666,-54.226421,-56.207939,-61.042877,-49.511692,-57.328854,-74.629662,-65.304993,-65.577377,-42.548203,-35.769562,-31.319229,-19.867664,-18.980085,-29.109901,-34.638065,-38.529915,-41.396324,-43.963039,-48.330929,-50.333519,-49.423073,-54.267906,-46.272346,-46.065887,-44.952087,-35.725456,-29.932182,-30.547907,-15.432733,-16.786537,-32.958542,-33.055019,-34.288239,-39.436153,-42.701843,-58.637627,-50.816669,-44.610722,-44.273670,-47.153107,-47.661980,-45.265919,-41.279224,-33.102535,-34.840668,-25.919052,-23.316271,-28.870319,-37.088573,-42.877769,-49.070984,-52.847923,-51.607124,-52.037903,-55.759289,-50.031799,-47.310337,-49.114590,-47.980759,-43.395561,-37.687679,-49.887527,-26.400784,-28.594635,-38.479298,-43.937664,-50.532650,-62.202526,-57.405998,-56.286469,-58.437160,-58.778866,-61.991093,-59.734993,-61.730713,-57.915119,-49.013103,-44.450600,-39.590199,-28.904121,-29.635992,-39.553547,-42.366062,-48.149223,-50.218441,-78.059998,-55.831421,-55.882973,-57.157307,-57.399380,-56.024639,-53.891891,-53.622719,-46.674694,-42.370491,-48.724281,-30.077616,-31.873600,-42.733315,-46.560139,-53.099556,-56.459049,-56.799137,-61.152084,-66.865654,-65.439117,-56.437237,-72.334129,-69.180763,-57.547413,-52.275108,-46.363708,-45.186901,-34.381321,-35.491268,-43.958332,-46.629307,-48.837830,-52.106796,-61.366421,-56.450214,-54.238552,-59.301212,-60.050346,-61.339848,-61.916935,-61.897438,-51.527084,-46.250523,-59.307266,-34.035175,-37.383240,-44.978878,-52.087482,-53.373737,-51.360603,-49.036453,-56.503239,-63.731358,-54.132168,-52.265739,-64.423149,-63.108593,-55.361027,-47.264275,-43.033215,-43.510963,-34.642151,-36.177586,-43.986126,-45.045826,-46.736225,-47.615688,-55.515419,-53.650135,-53.279007,-57.200806,-60.525555,-58.982311,-63.798660,-73.160278,-54.349594,-49.714699,-56.670452,-38.843636,-41.270767,-49.759624,-52.816120,-70.630852,-56.964783,-56.518078,-65.642532,-61.572205,-69.358505,-62.653858,-69.644485,-62.417057,-62.849155,-54.851810,-48.053993,-50.827892,-39.796520,-41.308792,-48.717129,-50.268513,-51.534508,-53.022648,-56.508427,-60.388863,-59.717556,-63.930061,-65.187378,-69.228455,-67.826904,-64.807640,-57.624924,-51.517277,-59.717175,-41.728302,-44.548943,-49.833698,-55.237770,-65.888680,-59.274063,-66.393402,-65.804237,-66.131226,-67.576660,-69.414581,-75.749832,-60.407986,-61.578087,-55.160728,-49.882774,-51.831097,-40.101582,-41.936069,-47.764355,-50.441914,-55.197998,-53.593578,-56.484756,-60.814384,-56.129669,-62.686367,-85.611977,-62.119404,-60.457470,-54.381618,-51.460556,-44.364029,-47.813656,-35.567287,-37.682529,-42.561146,-46.476967,-54.320370,-52.053150,-52.770851,-57.782993,-54.911911,-60.013065,-77.788101,-61.586227,-67.794609,-54.301628,-51.217560,-44.656296,-48.376553,-37.802944,-40.456638,-45.339005,-49.735180,-56.443478,-54.891525,-59.289703,-64.513176,-60.917217,-65.557816,-71.510956,-91.846733,-79.947647,-70.141861,-61.294922,-57.979824,-55.644466,-51.585243,-65.767197,-64.709152,-71.931389,-69.509605,-74.509811,-70.008636,-69.389847,-82.130333,-75.024925,-72.549088,-79.685806,-84.797676,-68.857323,-65.615219,-59.925266,-63.653675,-52.642616,-55.269283,-59.341988,-63.021576,-65.808434,-64.469055,-82.283875,-78.935585,-66.718781,-73.105621,-70.413979,-70.636482,-69.442673,-77.565636,-65.675980,-64.812393,-59.206020,-60.259750,-72.786133,-75.879570,-70.898201,-75.934982,-71.542809,-68.206596,-80.560577,-84.106758,-70.542473,-73.703926,-73.068260,-75.149719,-68.375694,-70.081619,-61.846176,-67.670830,-57.896362,-60.738670,-64.091942,-73.478134,-69.100006,-74.162628,-70.727791,-68.613846,-78.138046,-78.834183,-76.596725,-74.857468,-79.622627,-71.940086,-77.130745,-83.978203,-72.354378,-66.423134,-65.959091,-77.858589,-82.807961,-76.849937,-77.741982,-74.068970,-79.117043,-71.831024,-73.794189,-68.091980,-65.598518,-68.743835,-63.158249,-58.826916,-55.056465,-59.966496,-52.919662,-57.547688,-59.144970,-58.377930,-59.097164,-61.989708,-61.259003,-64.270538,-77.006966,-63.739758,-59.956459,-58.625439,-68.536263,-67.353882,-55.761356,-49.686741,-54.185539,-43.824787,-46.897541,-51.206825,-59.173088,-64.260147,-61.114178,-57.931702,-63.826351,-70.126518,-67.037430,-72.501541,-63.082108,-63.061665,-55.536465,-52.842125,-51.895695,-55.613327,-53.058296,-59.178314,-54.754112,-55.932552,-57.852509,-59.419098,-65.150574,-63.155701,-73.366295,-75.015373,-65.773109,-65.848251,-65.617264,-64.201759,-60.087658,-60.143379,-65.197746,-54.308987,-58.830803,-63.493641,-72.533920,-72.831665,-71.629402,-78.889053,-71.980179,-77.177185,-72.560356,-75.785538,-70.668365,-73.122391,-66.202072,-65.139839,-65.165085,-63.238781,-63.720791,-65.502083,-67.902031,-68.940872,-71.553490,-75.057510,-75.212204,-82.400665,-76.662949,-79.403229,-81.470627,-82.302025,-81.658836,-71.727806,-79.114334,-69.162537,-71.926842,-70.363266,-76.077370,-70.523415,-76.701881,-76.392448,-76.546486,-77.078056,-88.436264,-76.923927,-85.428291,-78.380211,-78.076897,-78.978569,-81.424019,-76.423119,-77.818771,-81.880524,-71.879066,-76.240341,-83.651253,-81.859245,-81.645172,-78.684059,-79.238762,-77.970421,-85.380096,-78.804291,-83.799744,-79.808189,-80.830818,-76.545357,-81.748962,-75.862648,-75.413155,-91.832382,-76.631058,-80.497993,-83.088295,-78.764549,-81.768539,-79.508385,-82.390388,-77.617447,-84.366394,-83.985771,-79.620674,-80.551018,-78.193291,-79.800766,-75.343155,-90.340210,-75.855255,-78.121223,-78.347725,-83.966400,-78.019981,-77.820335,-83.896606,-77.364235,-99.393852,-77.503952,-79.001923,-78.779213,-77.911713,-81.387115,-72.240913,-76.714607,-73.282089,-72.004509,-70.021332,-77.464607,-76.762970,-90.979935,-73.034088,-85.600090,-75.238243,-82.861038,-76.439819,-77.136719,-90.301353,-87.841331,-76.055168,-68.281075,-68.273048,-67.668762,-76.196213,-68.819740,-71.123322,-69.794624,-70.033325,-79.702232,-71.911781,-81.892776,-69.861282,-82.496544,-81.955597,-81.724464,-76.052246,-68.867691,-71.769409,-67.267418,-69.130470,-71.406265,-70.958832,-67.319801,-79.658707,-71.138863,-77.048164,-72.928581,-79.427628,-77.246346,-77.894554,-84.467216,-77.888298,-74.015114,-75.603737,-68.894516,-70.028152,-72.887642,-73.566811,-68.407600,-70.988419,-72.633408,-70.434258,-69.968864,-80.134773,-72.500587,-74.422043,-73.107101,-71.425545,-77.497795,-79.503975,-76.031517,-67.809570,-71.960846,-67.364288,-69.504646,-70.156143,-68.812149,-70.234489,-69.698990,-67.808052,-73.103600,-73.895111,-71.575142,-77.957352,-70.899918,-75.110725,-78.768394,-68.570297,-63.134830,-65.282578,-63.827351,-66.206940,-75.883484,-66.807571,-71.349701,-67.952469,-67.399254,-69.136330,-72.690063,-67.439079,-65.174080,-66.727219,-76.869911,-69.481468,-60.539238,-59.156216,-62.411926,-58.671406,-57.954857,-61.651157,-58.676674,-63.325569,-63.131195,-64.893639,-63.653809,-65.164299,-73.967171,-66.394630,-62.269100,-78.051476,-65.742020,-61.020607,-56.234104,-63.531033,-56.667534,-54.692329,-59.833160,-58.919552,-59.964603,-62.998318,-61.288681,-64.137772,-68.804695,-65.902168,-65.499435,-66.814163,-73.341309,-63.899441,-56.545551,-54.214149,-62.227928,-54.186474,-53.545959,-53.257992,-57.082058,-58.758743,-63.189152,-75.747437,-61.747955,-57.553978,-80.264046,-63.076302,-61.310005,-63.739967,-57.915810,-58.817852,-54.245060,-60.616386,-54.499065,-54.721172,-56.199963,-62.264221,-66.030319,-66.080978,-78.936203,-62.376030,-61.625507,-67.250626,-74.386971,-73.295929,-68.770424,-64.025810,-60.069107,-59.138382,-61.223301,-58.553154,-60.496937,-57.706825,-63.207050,-78.293007,-70.731728,-68.454956,-65.323936,-72.780373,-71.055359,-75.689644,-69.686493,-72.256821,-68.209938,-70.008347,-63.007545,-65.048691,-64.229218,-64.430367,-67.259880,-69.872993,-80.490608,-67.607208,-68.910027,-72.049492,-68.496765,-77.854088,-72.737930,-78.754349,-72.532028,-68.515686,-72.807739,-63.041588,-72.143532,-67.725143,-66.052719,-61.963455,-68.994240,-69.161095,-69.205154,-65.989754,-68.830063,-67.579575,-75.787613,-77.186882,-75.574852,-77.008942,-70.081833,-75.137543,-65.920464,-69.304726,-64.443878,-67.427261,-63.898460,-70.133751,-71.984200,-68.282578,-72.848328,-66.432983,-72.689789,-76.233589,-67.697197,-67.995186,-76.567764,-68.580139,-66.893059,-65.790512,-75.243340,-63.575474,-63.789932,-61.253025,-64.997169,-67.645119,-64.130829,-73.327751,-70.635811,-69.532814,-75.825150,-70.009399,-77.036583,-75.453674,-67.277710,-68.567429,-68.307922,-73.844521,-67.251663,-73.609055,-66.984047,-71.108421,-65.981590,-67.101746,-73.704498,-68.754364,-71.734360,-75.555328,-71.884735,-72.405952,-70.710144,-65.670631,-70.617699,-66.364029,-69.044533,-67.754456,-73.911415,-64.445839,-77.221878,-69.061142,-70.256355,-73.198830,-89.075623,-71.179230,-106.654839,-73.816452,-77.620583,-71.582939,-78.443840,-72.654770,-69.267998,-75.048622,-70.262329,-76.907181,-80.351875,-76.329086,-79.161743,-71.878754,-84.775948,-73.379364,-81.783386,-82.290825,-77.686180,-80.204208,-77.477455,-75.565353,-72.536781,-74.558594,-72.141586,-73.189178,-78.197319,-80.875710,-78.476883,-81.302856,-73.911270,-79.643875,-80.124626,-81.908180,-79.109200,-84.885666,-77.025093,-89.397339,-81.015991,-76.824585,-78.119606,-76.854134,-81.045952,-79.170387,-86.369095,-81.080017,-77.227089,-86.322266]);
  var sampleRate = 16000;
  var expected = [768, 1698, 3340];
  testGetFormants( ae, sampleRate, expected );
});
